# מדריך לטיפול בבעיות מיילים - Paintz

## הבעיה
לפעמים המערכת מציגה שהמייל נשלח אבל בפועל הוא לא נשלח.

## פתרונות

### 1. בדיקת הרשאות Gmail API
1. פתח את Google Apps Script
2. לך ל-Project Settings
3. בדוק ש-Gmail API מופעל
4. אם לא, הפעל אותו ונסה שוב

### 2. בדיקת הגדרות הפריסה
1. לך ל-Deploy > Manage deployments
2. בדוק שהסקריפט מפורסם כאפליקציית ווב
3. בדוק שה-URL נכון
4. אם לא, צור פריסה חדשה

### 3. בדיקת לוגים
1. פתח את Google Apps Script Console
2. הרץ את הפונקציות הבאות:
   - `testEmailSystem()`
   - `checkAdvancedPermissions()`
   - `diagnoseEmailIssues()`
   - `testModelImages()` (חדש - לבדיקת תמונות דגמים)
   - `testCustomDesignImages()` (חדש - לבדיקת תמונות עיצובים אישיים)
   - `testShoppingCartImages()` (חדש - לבדיקת תמונות סל קניות)
3. בדוק את הלוגים לשגיאות

### 4. בדיקת כתובות מייל
1. בדוק שכתובת המייל של הלקוח תקינה
2. בדוק שכתובת המייל של העסק תקינה
3. נסה לשלוח מייל לכתובת אחרת לבדיקה

### 5. בדיקת קוד
1. בדוק שהפונקציות `sendBusinessEmail` ו-`sendCustomerEmail` עובדות
2. בדוק שכל הנתונים נשלחים נכון
3. בדוק שאין שגיאות תחביר

### 6. טיפול בבעיות תמונות
1. **תמונות לא מופיעות במיילים:**
   - בדוק שהתמונות נשמרות כנתיבים יחסיים (כמו `img/Backgammon1.jpg`)
   - המערכת תמיר אוטומטית ל-URL מלא במיילים
   - אם התמונות עדיין לא מופיעות, בדוק שהדומיין נכון ב-Google Apps Script

2. **תמונות לא מופיעות בסל:**
   - בדוק שהתמונות נשמרות כנתיבים יחסיים ולא כ-base64
   - בדוק שהנתיבים נכונים (כמו `img/Backgammon1.jpg`)
   - בדוק שהתמונות קיימות בתיקיית `img/`

3. **תיקון נתיבי תמונות:**
   - שש בש: `img/Backgammon1.jpg`
   - תקליט: `img/img-record1.jpg`
   - קנבס: `img/canvas1.jpg`
   - מטקה: `img/matka1.jpg`

4. **תמונות דגמים לא מופיעות במיילים (תוקן 2025):**
   - הדומיין עודכן ל-`https://yardenfad.github.io/paintz-ben`
   - נוספו פונקציות `validateModelImageUrl()` ו-`testModelImages()`
   - תמונות דגמים עכשיו יוצגו במיילים
   - הרץ `testModelImages()` לבדיקת התמונות

5. **תמונות עיצובים אישיים לא מופיעות במיילים (תוקן 2025):**
   - תוקן נתיב התמונה של שש בש עיצוב אישי מ-`.jpeg` ל-`.jpg`
   - נוספו פונקציות `testCustomDesignImages()` ו-`testShoppingCartImages()`
   - כל תמונות העיצובים האישיים עכשיו יוצגו במיילים
   - הרץ `testCustomDesignImages()` לבדיקת התמונות

## פונקציות בדיקה

### testEmailSystem()
בודקת את כל מערכת המיילים כולל:
- הרשאות Gmail
- שליחת מייל פשוט
- פונקציות המייל

### checkAdvancedPermissions()
בודקת הרשאות מתקדמות:
- Gmail permissions
- Script permissions
- Deployment
- URL access

### diagnoseEmailIssues()
מאבחנת בעיות נפוצות:
- Gmail permissions error
- Basic email sending error
- Business email function error
- Customer email function error
- Script URL error

### testModelImages() (חדש)
בודקת תמונות דגמים:
- בדיקת נתיבי תמונות דגמים
- המרה ל-URL מלא
- בדיקת זמינות התמונות

### testCustomDesignImages() (חדש)
בודקת תמונות עיצובים אישיים:
- בדיקת נתיבי תמונות עיצובים אישיים
- המרה ל-URL מלא
- בדיקת זמינות התמונות

### testShoppingCartImages() (חדש)
בודקת תמונות סל קניות:
- בדיקת כל סוגי התמונות בסל
- המרה ל-URL מלא
- בדיקת זמינות התמונות

## הוראות שימוש

1. פתח את Google Apps Script Console
2. הרץ את הפונקציה הרצויה
3. בדוק את הלוגים
4. אם יש שגיאות, עקוב אחר ההוראות

## סיבות נפוצות

1. **הרשאות Gmail לא מופעלות** - הפעל Gmail API
2. **הסקריפט לא מפורסם** - צור פריסה חדשה
3. **כתובת מייל לא תקינה** - בדוק את הכתובות
4. **בעיות ברשת** - נסה שוב מאוחר יותר
5. **שגיאות בקוד** - בדוק את הלוגים
6. **תמונות לא מופיעות** - בדוק נתיבי התמונות
7. **תמונות דגמים לא מופיעות** - בדוק את הדומיין החדש

## טיפול בבעיות מיילים

### אם המיילים לא נשלחו:
1. **הסל נשמר** - לא יימחק אוטומטית
2. **נסה שוב** - המערכת תציג הודעה ברורה
3. **פנה לאינסטגרם** - @paintz.official

### אם תמונות דגמים לא מופיעות:
1. **בדוק את הדומיין** - צריך להיות `https://yardenfad.github.io/paintz-ben`
2. **הרץ `testModelImages()`** - לבדיקת התמונות
3. **בדוק את הלוגים** - לחפש שגיאות המרה
4. **וודא שהתמונות קיימות** - בתיקיית `Models/` 