<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart - Paintz</title>
  <link href="https://fonts.googleapis.com/css2?family=Amatica+SC:wght@700&family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
  <!-- <link href="./css/main.css" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;700;900&display=swap" rel="stylesheet">
  <script src="cart-sync.js"></script>
  <style>
    /* השארת רק scrollbar שעובד */
    html {
      overflow: hidden !important;
      height: 100% !important;
      width: 100% !important;
      max-width: 100vw !important;
    }
    
    body {
      background: #F9F1DC;
      font-family: 'Amatica SC', cursive;
      overflow-x: hidden !important;
      overflow-y: auto !important;
      height: 100% !important;
      width: 100% !important;
      max-width: 100vw !important;
      margin: 0;
      padding: 0;
    }
    
    *, *::before, *::after {
      box-sizing: border-box;
    }
    .body-center {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }
    /* Header */
    header {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-start;
      padding: 8px 10px;
      position: relative;
      width: 100%;
      max-width: 100vw;
      height: 90px;
      background: transparent;
      isolation: isolate;
      box-sizing: border-box;
    }
    .logo {
      width: 180px;
      height: 80px;
      background: url('logo.jpg') no-repeat center/cover;
      transform: rotate(0.67deg);
      z-index: 0;
    }
    .cart {
      position: absolute;
      width: 32px;
      height: 32px;
      right: 10px;
      top: 10px;
      z-index: 1;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .cart-icon {
      width: 32px;
      height: 32px;
      background: url('shop.svg') no-repeat center center;
      background-size: contain;
      background-color: transparent;
      position: relative;
    }
    .cart-badge {
      position: absolute;
      left: 50%;
      bottom: 3px;
      top: auto;
      transform: translateX(-50%);
      color: #111;
      font-size: 18px;
      font-family: 'Rubik', sans-serif;
      font-weight: bold;
      background: none;
      border: none;
      width: auto;
      height: auto;
      line-height: 1;
      display: block;
      z-index: 2;
      pointer-events: none;
    }
    /* Navigation Bar */
    nav {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      padding: 0 5vw;
      gap: 30px;
      width: 100%;
      max-width: 100vw;
      height: 44px;
      background: #BA8663;
      margin-bottom: 20px;
      box-sizing: border-box;
    }
    .nav-link {
      width: auto;
      min-width: 65px;
      height: 48px;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 32px;
      line-height: 48px;
      display: flex;
      align-items: center;
      text-align: center;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #fff;
      margin: 0 2vw;
      transform: rotate(0.52deg);
      background: transparent;
      cursor: pointer;
      text-decoration: none;
      justify-content: center;
    }
    /* Footer Section */
    footer {
      display: flex;
      flex-direction: row-reverse;
      justify-content: space-between;
      align-items: flex-start;
      background: #5C4638;
      padding: 10px 16px;
      box-sizing: border-box;
      height: 120px;
      direction: rtl;
      position: relative;
    }
    .footer-content {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
    }
    .footer-nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-right: auto;
      margin-left: auto;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      right: auto;
      top: 10px;
    }
    .footer-link {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 22px;
      color: white;
      text-decoration: none;
    }
    .footer-sep {
      font-size: 20px;
      color: white;
    }
    .footer-contact {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      position: absolute;
      bottom: 10px;
      left: 16px;
    }
    .footer-contact-item {
      display: flex;
      flex-direction: row-reverse;
      align-items: center;
      gap: 10px;
    }
    .footer-icon {
      width: 18px;
      height: 18px;
    }
    .footer-contact-text {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 18px;
      color: white;
    }
    .footer-logo {
      width: 90px;
      height: 90px;
      background: url('logo.jpg') no-repeat center/contain;
      border-radius: 12px;
    }
    .copyright-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0;
      gap: 2px;
      width: 100%;
      max-width: 100vw;
      height: 20px;
      background: transparent;
      margin-top: 2px;
      box-sizing: border-box;
    }
    .copyright-text {
      width: 180px;
      height: 20px;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 16px;
      color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }
    /* --- Shop Popup refined styles --- */
    .shop-popup {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      left: auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px #0002;
      z-index: 100;
      min-width: 140px;
      padding: 4px 0;
      font-family: 'Amatica SC', cursive;
      font-size: 18px;
      color: #5C4638;
      direction: rtl;
    }
    .shop-popup ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .shop-popup > ul > li {
      padding: 0 10px;
      margin-bottom: 1px;
      position: relative;
    }
    .shop-popup a, .shop-popup .popup-main-btn {
      color: #5C4638;
      text-decoration: none;
      background: none;
      border: none;
      font: inherit;
      cursor: pointer;
      padding: 2px 0;
      width: 100%;
      text-align: right;
      display: block;
      border-radius: 6px;
      transition: background 0.2s;
      line-height: 1.2;
      font-size: 18px;
    }
    .shop-popup a:hover, .shop-popup .popup-main-btn:hover {
      background: #f9f1dc;
    }
    .popup-sub {
      display: none;
      position: absolute;
      right: 100%;
      top: 0;
      background: #f6eee0;
      border-radius: 8px;
      box-shadow: 0 2px 8px #0001;
      padding: 2px 0;
      min-width: 110px;
      z-index: 101;
    }
    .popup-sub li {
      margin-bottom: 0;
      padding: 0 6px;
    }
    .popup-sub a {
      font-size: 15px;
      line-height: 1.2;
      padding: 2px 0;
    }
    .shop-popup .active + .popup-sub {
      display: block;
    }
    .shop-popup-btn {
      border: none !important;
      outline: none !important;
      box-shadow: none !important;
      background: transparent;
    }
    /* --- פופאפ חנות בפוטר --- */
    .footer-link-shop-popup {
      position: relative;
    }
    .footer-shop-popup {
      display: none;
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px #0002;
      z-index: 200;
      min-width: 140px;
      padding: 4px 0;
      font-family: 'Amatica SC', cursive;
      font-size: 18px;
      color: #5C4638;
      direction: rtl;
    }
    .big-cart-modal {
      background: #fff;
      border-radius: 22px;
      border: 1.5px solid #B8D8C2;
      box-shadow: 0 4px 24px #0001;
      max-width: 1100px;
      min-width: 320px;
      min-height: 70vh;
      width: 92vw;
      margin: 40px auto;
      padding: 40px 32px 32px 32px;
      color: #5A3E36;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      box-sizing: border-box;
    }
    @media (max-width: 900px) {
      .big-cart-modal {
        max-width: 99vw;
        padding: 16px 2vw 16px 2vw;
      }
    }

        /* Mobile responsive styles */
        @media (max-width: 700px) {
      /* Mobile Header */
      header {
        height: 70px;
        padding: 6px 8px;
      }
      
      .logo {
        width: 140px;
        height: 60px;
      }
      
      
      /* Mobile Navigation */
      nav {
        height: 40px;
        padding: 0 2vw;
        gap: 15px;
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
        margin-bottom: 15px;
      }
      
      .nav-link {
        font-size: 24px;
        line-height: 40px;
        height: 40px;
        min-width: 50px;
        margin: 0 1vw;
        white-space: nowrap;
        flex-shrink: 0;
      }
      
      /* Mobile Products Grid */
      .best-seller-list {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        padding: 0 10px;
      }
      
      .best-seller-card {
        width: 100%;
        max-width: 170px;
        height: 230px;
        margin: 0 auto;
      }
      
      .product-title {
        font-size: 36px;
        line-height: 50px;
      }
      
      /* Mobile Footer */
      footer {
        height: auto;
        min-height: 120px;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 15px 10px;
      }
      
      .footer-nav {
        position: static;
        transform: none;
        left: auto;
        top: auto;
        margin: 10px 0;
        flex-wrap: wrap;
        gap: 15px;
      }
      
      .footer-link {
        font-size: 18px;
      }
      
      .footer-contact {
        position: static;
        align-items: center;
        margin: 10px 0;
      }
      
      .footer-contact-text {
        font-size: 14px;
      }
      
      .footer-logo {
        width: 70px;
        height: 70px;
        margin: 10px 0;
      }
      
      /* Mobile Shop Popup */
      .shop-popup {
        top: 100%;
        right: 0;
        left: auto;
        min-width: 140px;
        font-size: 18px;
      }
      
      .shop-popup > ul > li {
        padding: 0 8px;
        margin-bottom: 0;
      }
      
      .shop-popup a, .shop-popup .popup-main-btn {
        font-size: 18px;
        padding: 2px 0;
        line-height: 1.2;
      }
      
      .popup-sub {
        right: 100%;
        min-width: 100px;
        font-size: 16px;
      }
      
      .popup-sub a {
        font-size: 16px;
        padding: 2px 0;
      }

      /* Reset and Base Styles */
      * {
        word-break: keep-all !important;
        overflow-wrap: break-word !important;
        -webkit-hyphens: none !important;
        -ms-hyphens: none !important;
        hyphens: none !important;
      }

      body {
        margin: 0;
        padding: 0;
        background: #F9F1DC;
      }

      .body-center {
        padding: 0;
        margin: 0;
        min-height: 100vh;
        width: 100%;
      }

      /* Main Cart Container */
      main {
        padding: 0 10px;
        margin-bottom: 80px;
      }

      .big-cart-modal {
        margin: 0;
        padding: 10px;
        border: none;
        border-radius: 0;
        box-shadow: none;
        background: transparent;
        width: 100%;
      }

      .big-cart-header {
        font-size: 32px;
        text-align: center;
        margin: 10px 0 20px 0;
        color: #5A3E36;
      }

      /* Cart Items */
      .big-cart-list {
        gap: 12px;
      }
      
      /* Cart Summary */
      .big-cart-summary {
        background: #FFFFFF;
        border-radius: 20px 20px 20px 20px;
        padding: 20px;
        bottom: 10px !important;
        right: 0 !important;
        left: 0 !important;
        z-index: 98;
        box-shadow: 0 -4px 12px rgba(0,0,0,0.1);
      }

      .big-cart-item {
        background: #FFFFFF;
        border-radius: 15px;
        padding: 20px 0 20px 0 !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        position: relative;
        display: grid;
        grid-template-areas: 
          "remove image title"
          "remove image notes quantity"
          "remove image notes price";
        grid-template-columns: auto auto 1fr 40px !important;
        gap: 5px;
        align-items: start;
      }

      .big-cart-item-remove {
        grid-area: remove !important;
        position: static !important;
        margin: 1px !important;
        width: 15px !important;
        height: 15px !important;
        background: transparent !important;
        border-radius: 0 15px 0 0 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0 !important;
      }

      .big-cart-item-img {
        grid-area: image;
        width: 100px;
        height: 100px;
        border-radius: 10px;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }

      .big-cart-item-info {
        grid-area: title;
        padding: 0;
        margin: 0 !important;
        max-width: 100%;
        text-align: right;
      }

      .big-cart-item-title {
        font-size: 20px;
        font-weight: 900;
        color: #5A3E36;
        font-family: 'Amatica SC', cursive;
        margin-bottom: 2px;
        letter-spacing: 0.01em;
        line-height: 1.3;
        text-align: right;
        grid-area: title;
        padding: 0;
        margin: 0 !important;
        max-width: 100%;
        white-space: normal !important;
        word-wrap: break-word !important;
        word-break: keep-all !important;
        overflow-wrap: break-word !important;
        -webkit-hyphens: none !important;
        -ms-hyphens: none !important;
        hyphens: none !important;
      }

      .big-cart-item-notes {
        font-size: 16px;
        color: #7f8c8d;
        font-family: 'Amatica SC', cursive;
        text-align: right;
        line-height: 1.4;
        grid-area: notes;
        margin: 0;
        padding: 0;
        white-space: normal !important;
        word-wrap: break-word !important;
        word-break: keep-all !important;
        overflow-wrap: break-word !important;
        -webkit-hyphens: none !important;
        -ms-hyphens: none !important;
        hyphens: none !important;
      }

      .big-cart-item-qty {
        grid-area: quantity;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .qty-btn {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        background: #B8D8C2;
      }

      .qty-num {
        font-size: 18px;
        min-width: 30px;
      }

      .big-cart-item-price {
        grid-area: price;
        position: static;
        font-size: 18px;
        font-weight: bold;
        color: #5A3E36;
        text-align: left;
        margin: 0 !important;
        padding: 0;
      }


      .big-cart-total {
        font-size: 28px;
        text-align: center;
        margin-bottom: 15px;
        color: #5B9B86;
      }

      .big-cart-shipping {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 15px;
      }

      .big-cart-shipping label {
        font-size: 18px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .big-cart-shipping input[type="radio"] {
        width: 20px;
        height: 20px;
      }

      .big-cart-notes {
        display: none;
      }

      .big-cart-order-btn {
        display: block !important;
        width: 90% !important;
        max-width: 300px !important;
        margin: 15px auto !important;
        height: 50px !important;
        font-size: 20px !important;
        border-radius: 25px !important;
      }

      /* Empty Cart State */
      .big-cart-empty {
        text-align: center;
        padding: 40px 20px;
        font-size: 24px;
        color: #5A3E36;
      }
    }

    .big-cart-header {
      font-size: 54px;
      color: #5A3E36;
      text-align: right;
      margin-bottom: 32px;
      font-weight: 700;
      letter-spacing: 0.01em;
      font-family: 'Amatica SC', cursive;
    }
    .big-cart-list {
      width: 100%;
      max-width: 100%;
      min-height: 220px;
      margin-bottom: 32px;
      display: flex;
      flex-direction: column;
      gap: 24px;
      align-items: center;
    }
    .big-cart-item {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      justify-content: flex-end;
      background: #fff;
      border-radius: 16px;
      border: 1.5px solid #B8D8C2;
      box-shadow: 0 2px 12px #B8D8C230;
      width: 100%;
      max-width: 700px;
      padding: 24px;
      position: relative;
      transition: box-shadow 0.2s, border 0.2s;
      min-height: 80px;
    }
    .big-cart-item:hover {
      box-shadow: 0 4px 24px #F7E7B6;
      border-color: #F7E7B6;
    }
    .big-cart-item-remove {
      order: 1;
      margin: 0 0 0 18px;
      background: none;
      border: none;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
      flex-shrink: 0;
      align-self: center;
    }
    .big-cart-item-remove:hover {
      opacity: 1;
      background: #F7E7B6;
      border-radius: 50%;
    }
    .big-cart-item-trash-icon {
      width: 22px;
      height: 22px;
      background: url('trash.svg') no-repeat center/contain;
      display: inline-block;
    }
    .big-cart-item-img {
      order: 2;
      margin: 0 0 0 18px;
      width: 64px;
      height: 64px;
      border-radius: 10px;
      background: #F9F1DC;
      background-size: cover;
      background-position: center;
      flex-shrink: 0;
      border: 1px solid #F7E7B6;
      align-self: center;
    }
    .big-cart-item-info {
      order: 3;
      min-width: 0;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-start;
      justify-content: flex-start;
      text-align: right;
      margin-right: 0;
      position: relative;
      word-wrap: break-word;
      overflow-wrap: break-word;
      word-break: break-all;
      hyphens: auto;
      max-width: calc(100% - 220px);
      overflow: hidden;
    }
    .big-cart-item-title {
      grid-area: title;
      padding: 0;
      margin: 0 !important;
      max-width: 100%;
      text-align: right;
      white-space: normal !important;
      word-wrap: break-word !important;
      word-break: keep-all !important;
      overflow-wrap: break-word !important;
      -webkit-hyphens: none !important;
      -ms-hyphens: none !important;
      hyphens: none !important;
    }
    .big-cart-item-notes {
      grid-area: notes;
      margin: 0;
      padding: 0;
      line-height: 1 !important;
      text-align: right;
      white-space: normal !important;
      word-wrap: break-word !important;
      word-break: keep-all !important;
      overflow-wrap: break-word !important;
      -webkit-hyphens: none !important;
      -ms-hyphens: none !important;
      hyphens: none !important;
    }
    .side-cart-item-details-label {
      color: #5EA189;
      font-weight: bold;
      flex-shrink: 0;
      text-align: right;
      margin-left: 4px;
      font-size: 16px;
      font-family: 'Amatica SC', cursive;
      word-wrap: break-word;
      overflow-wrap: break-word;
      word-break: break-all;
      white-space: normal;
    }
    .side-cart-item-color-box {
      display: inline-block;
      width: 11px;
      height: 11px;
      border-radius: 2px;
      border: 1px solid #ccc;
      margin-left: 4px;
      vertical-align: middle;
      align-self: center;
    }
    /* שבירת טקסט לכל הליסט איטמים */
    .big-cart-item-notes li {
      word-wrap: break-word;
      overflow-wrap: break-word;
      word-break: break-all;
      white-space: normal;
      hyphens: auto;
    }
    .big-cart-item-qty {
      order: 4;
      margin: 0 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      flex-shrink: 0;
      align-self: center;
      height: 28px;
    }
    .qty-btn {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #C5E1D1;
      border: none;
      color: white;
      font-size: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
      padding: 0;
      line-height: 1;
      font-family: Arial, sans-serif;
      position: relative;
    }
    .qty-btn::after {
      content: '+';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      line-height: 1;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .qty-btn.minus-btn::after {
      content: '-';
      padding-bottom: 4px;
    }
    .qty-btn:hover {
      background: #B8D8C2;
    }
    .qty-num {
      font-size: 18px;
      color: #5A3E36;
      font-family: 'Amatica SC', cursive;
      min-width: 28px;
      text-align: center;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 28px;
      line-height: 1;
    }
    .big-cart-item-btn {
      background: #B8D8C2;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      font-size: 22px;
      cursor: pointer;
      transition: background 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Assistant', Arial, sans-serif;
    }
    .big-cart-item-btn:hover {
      background: #5B9B86;
    }
    .big-cart-item-price {
      position: absolute;
      left: 24px;
      bottom: 8px;
      font-size: 18px;
      color: #5A3E36;
      font-weight: 700;
      font-family: 'Amatica SC', cursive;
      margin: 0;
      min-width: 110px;
      text-align: left;
      z-index: 10;
      background: rgba(255, 255, 255, 0.9);
      padding: 2px 4px;
      border-radius: 4px;
    }
    .custom-price {
      color: #5A3E36;
      font-size: 18px;
      font-weight: 700;
      position: absolute;
      left: 24px;
      bottom: 8px;
      margin: 0;
      min-width: 110px;
      text-align: left;
      z-index: 10;
      background: rgba(255, 255, 255, 0.9);
      padding: 2px 4px;
      border-radius: 4px;
    }
    .big-cart-summary {
      margin-top: 18px;
      display: flex;
      flex-direction: column;
      gap: 18px;
      width: 100%;
      max-width: 700px;
      align-items: flex-end;
      text-align: right;
      position: relative;
      font-family: 'Amatica SC', cursive;
    }
    .big-cart-divider {
      width: 100%;
      max-width: 700px;
      border: none;
      border-top: 1.5px solid #B8D8C2;
      margin: 24px 0 16px 0;
    }
    .big-cart-total {
      font-size: 32px;
      color: #5B9B86;
      font-weight: 900;
      text-align: right;
      align-self: flex-end;
      margin-bottom: 8px;
      font-family: 'Amatica SC', cursive;
    }
    .big-cart-total span {
      color: #5A3E36;
      font-size: 24px;
    }
    .big-cart-shipping {
      display: flex;
      flex-direction: row;
      gap: 40px;
      align-items: center;
      margin-bottom: 8px;
      justify-content: space-between;
      text-align: left;
      font-family: 'Amatica SC', cursive;
      font-size: 20px;
      width: 100%;
    }
    .big-cart-shipping label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 20px;
      color: #5A3E36;
      font-family: 'Amatica SC', cursive;
      cursor: pointer;
      padding-right: 2px;
    }
    .big-cart-shipping input[type="radio"] {
      accent-color: #B8D8C2;
      width: 18px;
      height: 18px;
      margin-left: 6px;
      margin-right: 0;
      vertical-align: middle;
    }
    .big-cart-notes-label {
      font-size: 15px;
      color: #7f8c8d;
      font-family: 'Assistant', Arial, sans-serif;
      margin-bottom: 4px;
      margin-top: 18px;
      text-align: right;
      display: block;
    }
    .big-cart-notes {
      width: 100%;
      max-width: 600px;
      min-height: 100px;
      border-radius: 12px;
      border: 1.5px solid #B8D8C2;
      padding: 12px 14px;
      font-size: 18px;
      font-family: 'Amatica SC', cursive;
      margin: 0 0 0 auto;
      resize: vertical;
      display: block;
      box-sizing: border-box;
      color: #5A3E36;
      text-align: right;
    }
    .big-cart-notes::placeholder {
      color: #bdbdbd;
      font-size: 16px;
      font-family: 'Amatica SC', cursive;
    }
    .big-cart-order-btn {
      width: 100%;
      max-width: 340px;
      height: 54px;
      background: #5B9B86;
      color: #fff;
      font-size: 20px;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      border: none;
      border-radius: 12px;
      margin-top: 16px;
      cursor: pointer;
      transition: background 0.2s;
      text-align: center;
      padding: 0 16px;
      letter-spacing: 0.01em;
      box-shadow: 0 2px 8px #B8D8C220;
      display: block;
      align-self: flex-start;
    }
    .big-cart-order-btn:hover {
      background: #40796b;
    }
    .big-cart-order-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      opacity: 0.5;
    }
    .big-cart-order-btn:disabled:hover {
      background: #ccc;
    }
    

  </style>
</head>
<body>
    <div class="body-center">
    <header>
        <div class="logo"></div>
    </header>
    <nav>
        <a class="nav-link" href="homepage.html">דף הבית</a>
        <button class="nav-link shop-popup-btn" id="shopPopupBtn" type="button">חנות</button>
        <a class="nav-link" href="policy.html">מדיניות</a>
        <a class="nav-link" href="contact.html">צור קשר</a>
    </nav>
    <!-- Popup (ממש אחרי ה-nav) -->
    <div class="shop-popup" id="shopPopup">
      <ul>
        <li><a href="shop.html">כללי</a></li>
        <li>
          <button class="popup-main-btn" type="button" data-target="sheshbesh">שש בש</button>
          <ul class="popup-sub" id="sub-sheshbesh">
            <li><a href="Backgammon Custum.html">עיצוב אישי</a></li>
            <li><a href="Backgammon Models.html">דגמים</a></li>
          </ul>
        </li>
        <li>
          <button class="popup-main-btn" type="button" data-target="matkot">מטקות</button>
          <ul class="popup-sub" id="sub-matkot">
            <li><a href="Matka Custum.html">עיצוב אישי</a></li>
            <li><a href="Matka Models.html">דגמים</a></li>
          </ul>
        </li>
        <li><a href="Canvas.html">קנבסים</a></li>
        <li><a href="Record.html">תקליטים</a></li>
      </ul>
    </div>
    <main style="display: flex; flex-direction: column; align-items: center;">
      <div class="big-cart-modal">
        <div class="big-cart-header">סל הקניות שלי</div>
        <div class="big-cart-list" id="bigCartList">
          <!-- כאן יתווספו כרטיסי המוצרים -->
        </div>
        <div class="big-cart-summary">
          <div class="big-cart-total">סה"כ: <span id="bigCartTotal">לפי הצעת מחיר</span></div>
          <div class="big-cart-shipping">
            <div style="display: flex; gap: 20px; justify-content: flex-end;">
              <label><input type="radio" name="shipping" value="pickup"> איסוף עצמי (פתח תקווה)</label>
              <label><input type="radio" name="shipping" value="delivery" checked>  משלוח (50₪)</label>
            </div>
          </div>
          <textarea class="big-cart-notes" id="bigCartNotes" placeholder="הערות להזמנה (לא חובה)" oninput="saveBigCartNotes()"></textarea>
          <hr class="big-cart-divider" />
          <button class="big-cart-order-btn" id="bigCartOrderBtn">להמשך להזנת פרטים</button>
        </div>
      </div>
    </main>
    </div>
    <footer>
        <div class="footer-content">
          <div class="footer-nav">
            <a href="homepage.html" class="footer-link">דף הבית</a>
            <span class="footer-sep">|</span>
            <a href="shop.html" class="footer-link">חנות</a>
            <span class="footer-sep">|</span>
            <a href="policy.html" class="footer-link">מדיניות</a>
            <span class="footer-sep">|</span>
            <a href="contact.html" class="footer-link">צור קשר</a>
          </div>
      
          <div class="footer-contact">
            <div class="footer-contact-item">
              <a href="https://www.instagram.com/paintz.official/" target="_blank" rel="noopener">
                <img src="instagram.svg" alt="Instagram" class="footer-icon" />
              </a>
              <span class="footer-contact-text">paintz.official@</span>
            </div>
            <div class="footer-contact-item">
              <a href="mailto:paintz.yf@gmail.com">
                <img src="email.svg" alt="Email" class="footer-icon" />
              </a>
              <span class="footer-contact-text">paintz.yf@gmail.com</span>
            </div>
            <div class="footer-contact-item">
              <a href="https://maps.google.com/?q=פתח+תקווה" target="_blank">
                <img src="location.svg" alt="Location" class="footer-icon" />
              </a>
              <span class="footer-contact-text">פתח תקווה</span>
            </div>
          </div>
        </div>
      
        <div class="footer-logo"></div>
    </footer>
    <section class="copyright-section">
        <div class="copyright-text">Paintz 2025©</div>
    </section>

</body>
<script>
// Global variables and functions
let bigCart = [];
let deleteDialogIdx = null;

// Parse price robustly: supports strings like "₪ 350", with commas, NBSP and RTL chars
function parsePriceToNumber(priceValue) {
  if (typeof priceValue === 'number') return priceValue;
  if (!priceValue) return 0;
  try {
    const str = priceValue.toString();
    // Remove everything except digits and decimal point
    const cleaned = str.replace(/[^0-9.]/g, '');
    const num = parseFloat(cleaned);
    return isNaN(num) ? 0 : num;
  } catch (e) {
    return 0;
  }
}

function updateQuantity(idx, change) {
  if (bigCart[idx]) {
    const newQty = bigCart[idx].qty + change;
    if (newQty >= 1) {
      bigCart[idx].qty = newQty;
      saveBigCartToStorage(bigCart);
      renderBigCart();
      updateTotalPrice();
      if (window.cartSync && typeof window.cartSync.synchronize === 'function') {
        window.cartSync.synchronize('big-cart-quantity-change');
      }
    } else if (newQty === 0) {
      showDeleteDialog(idx);
    }
  }
}

function saveBigCartToStorage(bigCart) {
  try {
    localStorage.setItem('cart', JSON.stringify(bigCart));
  } catch (e) {
    console.error('Failed to save cart to localStorage:', e);
  }
}

function loadBigCartFromStorage() {
  try {
    const cartData = localStorage.getItem('cart');
    console.log('Raw cart data from localStorage:', cartData);
    if (cartData) {
      const parsedCart = JSON.parse(cartData);
      console.log('Parsed cart data:', parsedCart);
      if (Array.isArray(parsedCart)) {
        return parsedCart;
      }
    }
  } catch (e) {
    console.error('Failed to parse cart from localStorage:', e);
  }
  return [];
}

function updateTotalPrice() {
  let total = 0;
  let hasCustomProduct = false;
  
  bigCart.forEach(item => {
    if (item.title?.includes('עיצוב אישי')) {
      hasCustomProduct = true;
    } else if (item.price) {
      const priceNumber = parsePriceToNumber(item.price);
      if (!isNaN(priceNumber)) {
        total += priceNumber * item.qty;
      }
    }
  });

  // הוספת מחיר משלוח אם נבחר משלוח
  const selectedShipping = document.querySelector('input[name="shipping"]:checked')?.value;
  const shippingCost = selectedShipping === 'delivery' ? 50 : 0;
  
  // חישוב המחיר הכולל כולל משלוח
  const totalWithShipping = total + shippingCost;
  
  const totalElem = document.getElementById('bigCartTotal');
  if (totalElem) {
    if (hasCustomProduct) {
      if (totalWithShipping > 0) {
        totalElem.textContent = `₪${totalWithShipping} + הצעת מחיר תשלח בהמשך`;
      } else {
        totalElem.textContent = 'הצעת מחיר תשלח בהמשך';
      }
    } else {
      totalElem.textContent = '₪' + totalWithShipping;
    }
  }
}

function renderBigCart() {
  const list = document.getElementById('bigCartList');
  const orderBtn = document.getElementById('bigCartOrderBtn');
  
  if (!list) {
    console.error('bigCartList element not found');
    return;
  }
  list.innerHTML = '';
  
  // עדכון מצב הכפתור בהתאם לתוכן הסל
  if (orderBtn) {
    if (bigCart.length === 0) {
      orderBtn.disabled = true;
      orderBtn.style.opacity = '0.5';
      orderBtn.style.cursor = 'not-allowed';
      orderBtn.textContent = 'הסל ריק';
    } else {
      orderBtn.disabled = false;
      orderBtn.style.opacity = '1';
      orderBtn.style.cursor = 'pointer';
      orderBtn.textContent = 'להמשך להזנת פרטים';
    }
  }
  
  if (bigCart.length === 0) {
    list.innerHTML = '<div style="text-align: center; padding: 20px; font-family: \'Amatica SC\', cursive; font-size: 20px; color: #775A47;">העגלה ריקה</div>';
    return;
  }
  
  bigCart.forEach((item, idx) => {
    console.log('Cart item:', item);
    console.log('Cart item img property:', item.img);
    try {
      let isCustom = item.title && item.title.includes('עיצוב אישי');
      let priceCell;
      if (isCustom) {
        priceCell = `<div class='custom-price'>המחיר יקבע בהצעת מחיר</div>`;
      } else if (item.price) {
        const priceNumber = parsePriceToNumber(item.price);
        if (!isNaN(priceNumber)) {
          priceCell = `<div class='big-cart-item-price'>₪${priceNumber * item.qty}</div>`;
        } else {
          priceCell = `<div class='big-cart-item-price'>₪0</div>`;
        }
      } else {
        priceCell = `<div class='big-cart-item-price'>₪0</div>`;
      }
      let notes = '';
      try {
        if (window.cartSync && typeof window.cartSync.renderCartNotes === 'function') {
          notes = window.cartSync.renderCartNotes(item, true);
        } else if (item.notes) {
          notes = item.notes;
        }
      } catch (error) {
        console.error('Error rendering cart notes:', error);
        notes = item.notes || '';
      }
      const row = document.createElement('div');
      row.className = 'big-cart-item';
      row.innerHTML = `
        <button class="big-cart-item-remove" title="הסר"><span class="big-cart-item-trash-icon"></span></button>
        ${(() => {
          const rawImage = item.img || item.image || item.mainImage;
          if (!rawImage) return '<div class="big-cart-item-img"></div>';
          let primaryUrl = '';
          let fallbackUrl = '';
          if (rawImage.startsWith('data:')) {
            primaryUrl = rawImage;
            fallbackUrl = rawImage;
          } else if (rawImage.startsWith('http')) {
            const ghMarker = 'yardenfad.github.io/paintz-website/';
            if (rawImage.includes(ghMarker)) {
              const after = rawImage.split(ghMarker)[1] || '';
              primaryUrl = `${window.location.origin}/${after}`;
              fallbackUrl = rawImage;
            } else {
              primaryUrl = rawImage;
              fallbackUrl = rawImage;
            }
          } else {
            const normalizedPath = rawImage.replace(/^\//, '');
            primaryUrl = `${window.location.origin}/${normalizedPath}`;
            fallbackUrl = `https://yardenfad.github.io/paintz-website/${normalizedPath}`;
          }
          let imageUrl = primaryUrl;
          console.log('Cart item image URL (primary):', imageUrl);
          console.log('Original image fields:', { img: item.img, image: item.image, mainImage: item.mainImage });
          console.log('Item title:', item.title, 'subtitle:', item.subtitle);
          console.log('Is custom product:', item.title && item.title.includes('עיצוב אישי'));
          
          // בדיקה אם התמונה קיימת, ואם לא – נסה גיבוי מ-GitHub Pages
          const testImg = new Image();
          testImg.onload = () => console.log('✅ Image exists and loads successfully:', imageUrl);
          testImg.onerror = () => {
            console.warn('⚠️ Image failed to load (primary). Trying fallback:', fallbackUrl);
            const fallbackImg = new Image();
            fallbackImg.onload = () => {
              console.log('✅ Fallback image loads successfully:', fallbackUrl);
              const container = document.querySelector(`[data-img-id="img-${idx}"]`);
              if (container) {
                container.style.backgroundImage = `url('${fallbackUrl}')`;
              }
            };
            fallbackImg.onerror = () => console.error('❌ Image failed to load (fallback):', fallbackUrl);
            fallbackImg.src = fallbackUrl;
          };
          testImg.src = imageUrl;
          
          return `<div class=\"big-cart-item-img\" data-img-id=\"img-${idx}\" style=\"background-image:url('${imageUrl}'); background-size: cover; background-position: center; background-repeat: no-repeat;\"></div>`;
        })()}
        <div class="big-cart-item-info">
          <div class="big-cart-item-title">${item.subtitle ? `${item.title} | ${item.subtitle}` : item.title}</div>
          <div class="big-cart-item-notes">${notes}</div>
        </div>
        <div class="big-cart-item-qty">
          <button class="qty-btn minus-btn"></button>
          <span class="qty-num">${item.qty}</span>
          <button class="qty-btn plus-btn"></button>
        </div>
        ${priceCell}
      `;
      
      const minusBtn = row.querySelector('.minus-btn');
      const plusBtn = row.querySelector('.plus-btn');
      
      minusBtn.addEventListener('click', (e) => {
        e.preventDefault();
        updateQuantity(idx, -1);
      });
      
      plusBtn.addEventListener('click', (e) => {
        e.preventDefault();
        updateQuantity(idx, 1);
      });

      row.querySelector('.big-cart-item-remove').addEventListener('click', function() {
        showDeleteDialog(idx);
      });
      
      list.appendChild(row);
      
      // עדכן את הסכום בכל שינוי בכמות דרך כפתורי הפלוס/מינוס
      // הקריאות ל-updateQuantity כבר עושות renderBigCart + updateTotalPrice,
      // אך נוסיף עדכון בטוח כדי לטפל במקרי קצה של דפדפנים איטיים
      minusBtn.addEventListener('click', () => setTimeout(updateTotalPrice, 0));
      plusBtn.addEventListener('click', () => setTimeout(updateTotalPrice, 0));
    } catch (error) {
      console.error('Error rendering cart notes:', error);
    }
  });
  
  updateTotalPrice();
}

function removeItem(idx) {
  bigCart.splice(idx, 1);
  saveBigCartToStorage(bigCart);
  renderBigCart();
  updateTotalPrice();
  if (window.cartSync && typeof window.cartSync.synchronize === 'function') {
    window.cartSync.synchronize('big-cart-item-removed');
  }
}

function showDeleteDialog(idx) {
  deleteDialogIdx = idx;
  let dialog = document.getElementById('bigCartDeleteDialog');
  if (!dialog) {
    dialog = document.createElement('div');
    dialog.id = 'bigCartDeleteDialog';
    dialog.innerHTML = `
      <div style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.18);z-index:200;display:flex;align-items:center;justify-content:center;">
        <div style="background:#fff;border-radius:12px;box-shadow:0 2px 16px #0003;padding:32px 28px 18px 28px;min-width:260px;text-align:center;">
          <div style="font-family:'Amatica SC',cursive;font-size:22px;color:#775A47;margin-bottom:18px;">האם למחוק את המוצר מהעגלה?</div>
          <div style="display:flex;justify-content:center;gap:18px;">
            <button id="bigCartDeleteYes" style="background:#e74c3c;color:#fff;border:none;border-radius:8px;font-size:18px;font-family:'Amatica SC',cursive;padding:6px 22px;cursor:pointer;">כן</button>
            <button id="bigCartDeleteNo" style="background:#eee;color:#775A47;border:none;border-radius:8px;font-size:18px;font-family:'Amatica SC',cursive;padding:6px 22px;cursor:pointer;">לא</button>
          </div>
        </div>
      </div>
    `;
    document.body.appendChild(dialog);
  } else {
    dialog.style.display = 'flex';
  }
  document.getElementById('bigCartDeleteYes').onclick = function() {
    if (deleteDialogIdx !== null) {
      removeItem(deleteDialogIdx);
      deleteDialogIdx = null;
    }
    dialog.style.display = 'none';
  };
  document.getElementById('bigCartDeleteNo').onclick = function() {
    deleteDialogIdx = null;
    dialog.style.display = 'none';
  };
}

function saveBigCartNotes() {
  const notes = document.getElementById('bigCartNotes').value;
  localStorage.setItem('bigCartNotes', notes);
}

function loadBigCartNotes() {
  const notes = localStorage.getItem('bigCartNotes') || '';
  const notesField = document.getElementById('bigCartNotes');
  if (notesField) {
    notesField.value = notes;
  }
}

function saveShippingMethod() {
  const selectedShipping = document.querySelector('input[name="shipping"]:checked')?.value;
  if (selectedShipping) {
    localStorage.setItem('shippingMethod', selectedShipping);
  }
}

function loadShippingMethod() {
  const savedShipping = localStorage.getItem('shippingMethod');
  if (savedShipping) {
    const radioButton = document.querySelector(`input[name="shipping"][value="${savedShipping}"]`);
    if (radioButton) {
      radioButton.checked = true;
    }
  }
}

document.addEventListener('DOMContentLoaded', function() {
  // --- Shop Popup Logic ---
  const shopBtn = document.getElementById('shopPopupBtn');
  const shopPopup = document.getElementById('shopPopup');

  function positionShopPopup() {
    const rect = shopBtn.getBoundingClientRect();
    shopPopup.style.top = rect.bottom + 'px';
    shopPopup.style.right = (window.innerWidth - rect.right) + 'px';
  }

  if (shopBtn && shopPopup) {
    shopBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      if (shopPopup.style.display === 'block') {
        shopPopup.style.display = 'none';
        closeAllSubs();
      } else {
        positionShopPopup();
        shopPopup.style.display = 'block';
      }
    });

    shopBtn.addEventListener('mouseenter', function() {
      positionShopPopup();
      shopPopup.style.display = 'block';
    });

    let hideTimeout;
    
    function hidePopup() {
      hideTimeout = setTimeout(() => {
        shopPopup.style.display = 'none';
        closeAllSubs();
      }, 100);
    }
    
    function cancelHide() {
      if (hideTimeout) {
        clearTimeout(hideTimeout);
        hideTimeout = null;
      }
    }
    
    shopBtn.addEventListener('mouseleave', hidePopup);
    shopPopup.addEventListener('mouseenter', cancelHide);
    shopPopup.addEventListener('mouseleave', hidePopup);

    window.addEventListener('resize', function() {
      if (shopPopup.style.display === 'block') {
        positionShopPopup();
      }
    });
  }

  document.addEventListener('click', function(e) {
    if (shopPopup && !shopPopup.contains(e.target) && e.target !== shopBtn) {
      shopPopup.style.display = 'none';
      closeAllSubs();
    }
  });

  function closeAllSubs() {
    document.querySelectorAll('.popup-sub').forEach(sub => sub.style.display = 'none');
  }

  document.querySelectorAll('.popup-main-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.stopPropagation();
      const target = btn.getAttribute('data-target');
      const sub = document.getElementById('sub-' + target);
      if (sub.style.display === 'block') {
        sub.style.display = 'none';
      } else {
        closeAllSubs();
        sub.style.display = 'block';
      }
    });
  });

  // --- Big Cart Logic ---
  bigCart = loadBigCartFromStorage();
  
  // בדיקה אם יש מוצרים בסל
  if (bigCart.length > 0) {
  }

  function getColorFromName(name) {
    const colors = {
      'תכלת': '#7ed6f7',
      'טורקיז': '#40e0d0',
      'אדום': '#e74c3c',
      'כחול': '#2980b9',
      'ירוק': '#27ae60',
      'צהוב': '#f9e79f',
      'שחור': '#222',
      'לבן': '#fff',
      'כתום': '#f39c12',
      'סגול': '#8e44ad',
      'ורוד': '#fd79a8',
      'חום': '#a0522d',
      'אפור': '#7f8c8d',
      'זהב': '#ffd700',
      'כסף': '#bdc3c7',
    };
    return colors[name.trim()] || '#b2bec3';
  }

  // בדיקת אלמנטים
  const list = document.getElementById('bigCartList');
  const orderBtnElement = document.getElementById('bigCartOrderBtn');
  
  renderBigCart();
  loadBigCartNotes();
  loadShippingMethod();
  updateTotalPrice(); // עדכון המחיר הכולל בטעינת העמוד

  window.addEventListener('storage', function(e) {
    if (e.key === 'cart') {
      try {
        bigCart = JSON.parse(e.newValue || '[]');
        renderBigCart();
        updateTotalPrice(); // עדכון המחיר כשהסל מתעדכן מה-storage
      } catch (error) {
        console.error('Error syncing big cart from storage:', error);
      }
    }
  });

  window.addEventListener('focus', function() {
    try {
      bigCart = loadBigCartFromStorage();
      renderBigCart();
      updateTotalPrice(); // עדכון המחיר כשהסל מתעדכן מה-storage
    } catch (error) {
      console.error('Error syncing big cart on focus:', error);
    }
  });

  // הוספת event listeners לכפתורי הרדיו של שיטת המשלוח
  document.querySelectorAll('input[name="shipping"]').forEach(radio => {
    radio.addEventListener('change', function() {
      saveShippingMethod();
      updateTotalPrice(); // עדכון המחיר הכולל כשמשנים שיטת משלוח
    });
  });

  const orderBtn = document.getElementById('bigCartOrderBtn');
  if (orderBtn) {
    orderBtn.onclick = function() {
      // בדיקה אם יש מוצרים בסל
      if (bigCart.length === 0) {
        alert('הסל ריק. אנא הוסף מוצרים לפני המשך ההזמנה.');
        return;
      }
      
      const shipping = document.querySelector('input[name="shipping"]:checked')?.value;
      const notes = document.getElementById('bigCartNotes')?.value;
      
      localStorage.setItem('cart', JSON.stringify(bigCart));
      localStorage.setItem('deliveryMethod', shipping === 'delivery' ? 'delivery' : 'pickup');
      localStorage.setItem('notes', notes || '');
      localStorage.setItem('bigCartNotes', notes || '');
      
      window.location.href = 'Order.html';
    };
  }
});
</script>
</html> 