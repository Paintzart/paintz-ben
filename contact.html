<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>צור קשר - Paintz</title>
  <link href="https://fonts.googleapis.com/css2?family=Amatica+SC:wght@700&family=Amatic+SC:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@700&display=swap" rel="stylesheet">
  <style>
    /* גלילה תקינה */
    html {
      overflow-x: hidden !important;
      overflow-y: auto !important;
      height: 100% !important;
      width: 100% !important;
      max-width: 100vw !important;
    }
    
    body {
      background: #F9F1DC;
      overflow-x: hidden !important;
      overflow-y: auto !important;
      height: 100% !important;
      width: 100% !important;
      max-width: 100vw !important;
      margin: 0;
      padding: 0;
    }
    
    *, *::before, *::after {
      box-sizing: border-box;
    }
    .body-center {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }
    
    /* Header */
    header {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-start;
      padding: 8px 10px;
      position: relative;
      width: 100%;
      max-width: 100vw;
      height: 90px;
      background: transparent;
      isolation: isolate;
      box-sizing: border-box;
    }
    .logo {
      width: 180px;
      height: 80px;
      background: url('logo.jpg') no-repeat center/cover;
      transform: rotate(0.67deg);
      z-index: 0;
    }
    .cart {
      position: absolute;
      width: 32px;
      height: 32px;
      right: 10px;
      top: 10px;
      z-index: 1;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .cart-icon {
      width: 32px;
      height: 32px;
      background: url('shop.svg') no-repeat center center;
      background-size: contain;
      background-color: transparent;
      position: relative;
    }
    .cart-badge {
      position: absolute;
      left: 50%;
      bottom: 3px;
      top: auto;
      transform: translateX(-50%);
      color: #111;
      font-size: 18px;
      font-family: 'Rubik', sans-serif;
      font-weight: bold;
      background: none;
      border: none;
      width: auto;
      height: auto;
      line-height: 1;
      display: block;
      z-index: 2;
      pointer-events: none;
    }

    /* Navigation Bar */
    nav {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      padding: 0 5vw;
      gap: 30px;
      width: 100%;
      max-width: 100vw;
      height: 44px;
      background: #BA8663;
      margin-bottom: 20px;
      box-sizing: border-box;
    }
    .nav-link {
      width: auto;
      min-width: 65px;
      height: 48px;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 32px;
      line-height: 48px;
      display: flex;
      align-items: center;
      text-align: center;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #fff;
      margin: 0 2vw;
      transform: rotate(0.52deg);
      background: transparent;
      cursor: pointer;
      text-decoration: none;
      justify-content: center;
    }

    /* Contact Section */
    .contact-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px 20px 40px 20px;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .contact-title {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 50px;
      color: #775A47;
      text-align: center;
      margin-bottom: 30px;
      margin-top: 0;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .contact-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      width: 100%;
      max-width: 1000px;
    }

    /* Contact Form */
    .contact-form {
      background: #fff;
      padding: 25px 40px 40px 40px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .form-title {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 36px;
      color: #3e8f76;
      text-align: center;
      margin-bottom: 30px;
      margin-top: 0;
      text-transform: uppercase;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-family: 'Rubik', sans-serif;
      font-weight: 700;
      font-size: 16px;
      color: #775A47;
      margin-bottom: 8px;
    }

    .required-asterisk {
      color: #e74c3c;
    }

    .form-input, .form-textarea {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #D3B895;
      border-radius: 8px;
      font-family: 'Rubik', sans-serif;
      font-size: 16px;
      background: #fff;
      color: #775A47;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }

    .form-input:focus, .form-textarea:focus {
      outline: none;
      border-color: #BA8663;
    }

    .form-textarea {
      min-height: 120px;
      resize: vertical;
    }

    .form-submit {
      width: 100%;
      padding: 15px;
      background: #5EA189;
      color: #fff;
      border: none;
      border-radius: 10px;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 24px;
      text-transform: uppercase;
      cursor: pointer;
      transition: background-color 0.3s;
      margin-top: 10px;
    }

    .form-submit:hover {
      background: #4a8a6f;
    }

    /* Contact Info */
    .contact-info {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .info-card {
      background: #fff;
      padding: 20px 15px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .info-title {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 26px;
      color: #3e8f76;
      margin: 0 0 15px 0;
      text-transform: uppercase;
      text-align: center;
      direction: rtl;
    }

    .contact-item {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
      margin-bottom: 10px;
      font-family: 'Rubik', sans-serif;
      font-size: 16px;
      color: #775A47;
      text-align: left;
      width: 100%;
      flex-direction: row;
    }

    .contact-icon {
      width: 24px;
      height: 24px;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }

    .contact-link {
      color: #775A47;
      text-decoration: none;
      transition: color 0.3s;
    }

    .contact-link:hover {
      color: #BA8663;
    }

    .how-it-works {
      background: #D3B895;
      padding: 18px 15px;
      border-radius: 12px;
      margin-top: 12px;
    }

    .how-title {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 24px;
      color: #775A47;
      margin: 0 0 12px 0;
      text-transform: uppercase;
      text-align: center;
      direction: rtl;
    }

    .how-text {
      font-family: 'Rubik', sans-serif;
      font-size: 15px;
      color: #775A47;
      line-height: 1.2;
      text-align: center;
      margin: 0;
    }

    /* Footer */
    footer {
      display: flex;
      flex-direction: row-reverse;
      justify-content: space-between;
      align-items: flex-start;
      background: #5C4638;
      padding: 10px 16px;
      box-sizing: border-box;
      height: 120px;
      direction: rtl;
      position: relative;
      margin-top: 40px;
    }

    .footer-content {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 100%;
    }

    .footer-nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-right: auto;
      margin-left: auto;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      right: auto;
      top: 10px;
    }

    .footer-link {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 22px;
      color: white;
      text-decoration: none;
    }

    .footer-sep {
      font-size: 18px;
      color: white;
      font-weight: 100;
    }

    .footer-contact {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      position: absolute;
      bottom: 10px;
      left: 16px;
    }

    .footer-contact-item {
      display: flex;
      flex-direction: row-reverse;
      align-items: center;
      gap: 10px;
    }

    .footer-icon {
      width: 18px;
      height: 18px;
    }

    .footer-contact-text {
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 18px;
      color: white;
    }

    .footer-logo {
      width: 90px;
      height: 90px;
      background: url('logo.jpg') no-repeat center/contain;
      border-radius: 12px;
    }

    .copyright-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0;
      gap: 2px;
      width: 100%;
      max-width: 100vw;
      height: 20px;
      background: transparent;
      margin-top: 2px;
      box-sizing: border-box;
    }

    .copyright-text {
      width: 180px;
      height: 20px;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      font-size: 16px;
      color: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    /* Shop Popup refined styles */
    .shop-popup {
      display: none;
      position: fixed;
      top: 100%;
      right: 0;
      left: auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px #0002;
      z-index: 1000;
      min-width: 140px;
      padding: 4px 0;
      font-family: 'Amatica SC', cursive;
      font-size: 18px;
      color: #5C4638;
      direction: rtl;
    }

    .shop-popup ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .shop-popup > ul > li {
      padding: 0 10px;
      margin-bottom: 1px;
      position: relative;
    }

    .shop-popup a, .shop-popup .popup-main-btn {
      color: #5C4638;
      text-decoration: none;
      background: none;
      border: none;
      font: inherit;
      cursor: pointer;
      padding: 2px 0;
      width: 100%;
      text-align: right;
      display: block;
      border-radius: 6px;
      transition: background 0.2s;
      line-height: 1.2;
      font-size: 18px;
    }

    .shop-popup a:hover, .shop-popup .popup-main-btn:hover {
      background: #f9f1dc;
    }

    .popup-sub {
      display: none;
      position: absolute;
      right: 100%;
      top: 0;
      background: #f6eee0;
      border-radius: 8px;
      box-shadow: 0 2px 8px #0001;
      padding: 2px 0;
      min-width: 110px;
      z-index: 101;
    }

    .popup-sub li {
      margin-bottom: 0;
      padding: 0 6px;
    }

    .popup-sub a {
      font-size: 15px;
      line-height: 1.2;
      padding: 2px 0;
    }

    .shop-popup .active + .popup-sub {
      display: block;
    }

    .shop-popup-btn {
      border: none !important;
      outline: none !important;
      box-shadow: none !important;
      background: transparent;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .contact-content {
        grid-template-columns: 1fr;
        gap: 40px;
      }
      
      .contact-form, .info-card {
        padding: 25px;
      }
      
      .contact-title {
        font-size: 48px;
      }
      
      .form-title, .info-title {
        font-size: 24px;
      }
      
      nav {
        padding: 0 2vw;
        gap: 15px;
      }
      
      .nav-link {
        font-size: 24px;
        margin: 0 1vw;
      }
    }

    /* Mobile Specific Styles */
    @media (max-width: 700px) {
      .contact-section {
        padding: 0;
      }
      
      .contact-title {
        font-size: 36px;
        margin: 0;
        padding: 0;
        line-height: 1;
      }
      
      .contact-content {
        gap: 4px;
      }
      
      .contact-info {
        gap: 0;  /* Remove gap between cards */
      }
      
      .info-card {
        padding: 6px;
      }
      
      .info-title {
        margin-bottom: 2px;  /* Minimal margin after title */
      }
      
      .contact-item {
        padding: 0;  /* Remove all padding */
        margin: 0;  /* Remove all margins */
        min-height: 20px;  /* Ensure minimum height for clickability */
        height: 20px;  /* Fixed height */
        line-height: 20px;  /* Match height */
      }

      .contact-icon {
        width: 16px;
        height: 16px;
        margin: 2px 0;  /* Small vertical margin to center */
      }

      .contact-link {
        line-height: 20px;  /* Match height */
      }
      
      .how-it-works {
        padding: 6px;
        margin: 2px 0 0 0;
      }
      
      .how-title {
        margin: 0;
        font-size: 18px;
        line-height: 1;
      }
      
      .how-text {
        line-height: 1;
        margin: 4px 0 0 0;
        font-size: 14px;
      }

      .contact-form {
        padding: 8px;
        margin: 0;
        box-shadow: none;
      }

      .form-title {
        margin: 0 0 6px 0;
        font-size: 20px;
        line-height: 1;
      }

      .form-group {
        margin-bottom: 6px;
      }

      .form-label {
        margin-bottom: 1px;
        font-size: 14px;
      }

      .form-input, .form-textarea {
        padding: 6px;
        margin: 0;
        font-size: 14px;
      }

      .form-submit {
        margin-top: 6px;
        padding: 8px;
        font-size: 18px;
      }

      nav {
        margin: 0;
      }

      .success-message {
        padding: 8px;
        margin: 4px 0;
        font-size: 14px;
      }

      .shop-popup {
        top: 100%;
        right: 0;
        left: auto;
        min-width: 140px;
      }

      .popup-sub {
        position: absolute;
        right: auto;
        left: -110px; /* Width of sub-menu */
        top: 0;
        background: #f6eee0;
        border-radius: 8px;
        box-shadow: 0 2px 8px #0001;
        padding: 2px 0;
        min-width: 110px;
        z-index: 101;
      }

      .popup-main-btn.active + .popup-sub {
        display: block;
      }

      /* Ensure main menu items have position relative for proper sub-menu positioning */
      .shop-popup > ul > li {
        position: relative;
      }
    }

    /* Success Message */
    .success-message {
      background: #d4edda;
      color: #155724;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
      font-family: 'Rubik', sans-serif;
      display: none;
    }

    /* Field Error Messages */
    .field-error {
      color: #e74c3c;
      font-size: 14px;
      font-family: 'Rubik', sans-serif;
      margin-top: 5px;
      display: none;
    }

    /* Side Cart Styles */
    .cart-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.25);
      z-index: 99;
      transition: opacity 0.3s;
    }
    .cart-overlay.active {
      display: block;
      opacity: 1;
    }
    .side-cart {
      position: fixed;
      top: 0;
      right: -100%;
      width: 370px;
      max-width: 90vw;
      height: 100vh;
      background: #fff;
      box-shadow: -2px 0 16px #0002;
      z-index: 100;
      transform: translateX(100%);
      transition: all 0.35s cubic-bezier(.7,.2,.2,1);
      display: flex;
      flex-direction: column;
      padding: 0;
      visibility: hidden;
      opacity: 0;
      pointer-events: none;
    }
    .side-cart.active {
      right: 0;
      transform: translateX(0);
      visibility: visible;
      opacity: 1;
      pointer-events: auto;
    }
    .side-cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 20px 10px 20px;
      border-bottom: 1px solid #eee;
      background: #BA8663;
    }
    .side-cart-title {
      font-family: 'Amatica SC', cursive;
      font-size: 32px;
      font-weight: 700;
      color: #fff;
    }
    .side-cart-close {
      background: none;
      border: none;
      font-size: 32px;
      color: #775A47;
      cursor: pointer;
      font-family: inherit;
      line-height: 1;
    }
    .side-cart-list {
      flex: 1;
      overflow-y: auto;
      padding: 10px 0 0 0;
      background: #fff;
    }
    .side-cart-item {
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      background: #F9F1DC;
      border-radius: 8px;
      margin: 0 16px 12px 16px;
      padding: 10px 10px 10px 6px;
      box-shadow: 0 1px 4px #0001;
      position: relative;
      min-height: 60px;
      user-select: none;
      overflow: hidden;
    }
    .side-cart-item-header {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      height: 70px;
      min-height: 70px;
    }
    .side-cart-item-title-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      flex: 1;
      margin: 0;
      padding: 0;
      min-width: 0;
    }
    .side-cart-item-title-main, .side-cart-item-title-sub {
      font-size: 20px;
      font-weight: 800;
      color: #775A47;
      font-family: 'Amatica SC', cursive;
      line-height: 1.08;
      text-align: center;
      margin: 0;
      padding: 0;
      max-width: 90px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .side-cart-item-title-sub {
      font-weight: 800;
      margin-top: 0;
      margin-bottom: 0;
    }
    .side-cart-item-qty {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 400;
      color: #BA8663;
      width: 32px;
      height: 22px;
      background: #f6eee0;
      border-radius: 8px;
      text-align: center;
      margin: 0;
      font-family: 'Amatica SC', cursive;
    }
    .side-cart-item-details {
      margin: 6px 0 0 0;
      padding: 0;
      width: 100%;
    }
    .side-cart-item-details-list {
      list-style: none;
      margin: 0;
      padding: 0;
      text-align: right;
      max-width: 100%;
      overflow: hidden;
    }
    .side-cart-item-details-list li {
      font-size: 15px;
      color: #5C4638;
      background: none;
      border-radius: 0;
      margin-bottom: 0;
      padding: 0;
      font-family: 'Amatica SC', cursive;
      font-weight: 700;
      direction: rtl;
      line-height: 1.5;
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .side-cart-item-details-label {
      color: #5EA189;
      font-weight: bold;
      flex-shrink: 0;
      text-align: right;
    }
    .side-cart-item-details-value {
      flex: 1;
      min-width: 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .side-cart-item-color-box {
      display: inline-block;
      width: 11px;
      height: 11px;
      border-radius: 2px;
      border: 1px solid #ccc;
      margin-left: 4px;
      vertical-align: middle;
      align-self: center;
    }
    .side-cart-item-actions {
      position: absolute;
      left: 8px;
      bottom: 6px;
      display: flex;
      flex-direction: row;
      gap: 6px;
      z-index: 2;
    }
    .side-cart-item-trash-btn, .side-cart-item-add-btn {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.7;
      transition: opacity 0.2s;
    }
    .side-cart-item-trash-btn:hover, .side-cart-item-add-btn:hover {
      opacity: 1;
    }
    .side-cart-item-trash-icon {
      width: 20px;
      height: 20px;
      background: url('trash.svg') no-repeat center/contain;
      display: inline-block;
    }
    .side-cart-item-plus-icon {
      font-size: 20px;
      font-weight: bold;
      color: #5EA189;
      display: inline-block;
      line-height: 1;
    }
    /* דיאלוג מחיקה */
    .cart-delete-dialog {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.18);
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .cart-delete-dialog-content {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 16px #0003;
      padding: 32px 28px 18px 28px;
      min-width: 260px;
      text-align: center;
    }
    .cart-delete-dialog-title {
      font-family: 'Amatica SC', cursive;
      font-size: 22px;
      color: #775A47;
      margin-bottom: 18px;
    }
    .cart-delete-dialog-actions {
      display: flex;
      justify-content: center;
      gap: 18px;
    }
    .cart-delete-btn-yes {
      background: #e74c3c;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-family: 'Amatica SC', cursive;
      padding: 6px 22px;
      cursor: pointer;
    }
    .cart-delete-btn-no {
      background: #eee;
      color: #775A47;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-family: 'Amatica SC', cursive;
      padding: 6px 22px;
      cursor: pointer;
    }
    @media (max-width: 700px) {
      .side-cart {
        width: 98vw;
        max-width: 98vw;
      }
      
      /* Ensure the view cart button is always visible on mobile */
      .side-cart-view-btn {
        position: sticky;
        bottom: 0;
        width: calc(100% - 32px);
        margin: 16px 16px 18px 16px;
        height: 48px;
        background: #5EA189;
        color: #fff;
        font-family: 'Amatica SC', cursive;
        font-size: 20px;
        font-weight: 700;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.2s;
        display: block;
        z-index: 10;
        box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
      }
      
      .side-cart-view-btn:hover {
        background: #4b8c74;
      }
      
      /* Adjust side-cart-list padding to prevent overlap */
      .side-cart-list {
        padding: 10px 0 80px 0;
      }
      
      /* Tablet styles for medium screens */
      @media (min-width: 701px) and (max-width: 1024px) {
        .side-cart-view-btn {
          position: sticky;
          bottom: 0;
          width: calc(100% - 32px);
          margin: 16px 16px 25px 16px;
          height: 48px;
          background: #5EA189;
          color: #fff;
          font-family: 'Amatica SC', cursive;
          font-size: 20px;
          font-weight: 700;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          transition: background 0.2s;
          display: block !important;
          z-index: 10;
          box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
        }
        
        .side-cart-view-btn:hover {
          background: #4b8c74;
        }
        
        /* Adjust side-cart-list padding to prevent overlap */
        .side-cart-list {
          padding: 10px 0 100px 0;
        }
      }
      
      /* iPad and Safari specific fixes */
      @media only screen and (min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 1) {
        .side-cart-view-btn {
          position: sticky !important;
          bottom: 0 !important;
          z-index: 9999 !important;
          -webkit-transform: none !important;
          transform: none !important;
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .side-cart-list {
          padding: 10px 0 120px 0;
        }
      }
      
      /* Safari specific fixes */
      @media screen and (-webkit-min-device-pixel-ratio: 0) {
        .side-cart-view-btn {
          position: sticky !important;
          bottom: 0 !important;
          z-index: 9999 !important;
          -webkit-transform: none !important;
          transform: none !important;
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
      }
      
      /* iOS Safari specific fixes */
      @supports (-webkit-touch-callout: none) {
        .side-cart-view-btn {
          position: sticky !important;
          bottom: 0 !important;
          z-index: 9999 !important;
          -webkit-transform: none !important;
          transform: none !important;
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
      }
      
      /* Mobile Header */
      header {
        height: 70px;
        padding: 6px 8px;
      }
      
      .logo {
        width: 140px;
        height: 60px;
      }
      
      .cart {
        width: 28px;
        height: 28px;
        right: 8px;
        top: 8px;
      }
      
      .cart-icon {
        width: 28px;
        height: 28px;
      }
      
      .cart-badge {
        font-size: 14px;
        bottom: 2px;
      }
      
      /* Mobile Navigation */
      nav {
        height: 40px;
        padding: 0 2vw;
        gap: 15px;
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
        margin-bottom: 15px;
      }
      
      .nav-link {
        font-size: 24px;
        line-height: 40px;
        height: 40px;
        min-width: 50px;
        margin: 0 1vw;
        white-space: nowrap;
        flex-shrink: 0;
      }
      
      /* Mobile Contact Section */
      .contact-section {
        padding: 20px 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
      }
      
      .contact-title {
        font-size: 48px;
        margin-bottom: 30px;
        text-align: center;
      }
      
      .contact-content {
        flex-direction: column;
        gap: 30px;
        align-items: center;
        justify-content: center;
        text-align: center;
      }
      
      .contact-form {
        width: 100%;
        max-width: 400px;
        padding: 20px;
        margin: 0 auto;
        text-align: center;
      }
      
      .form-title {
        font-size: 28px;
        margin-bottom: 20px;
        text-align: center;
      }
      
      .form-input, .form-textarea {
        font-size: 16px;
        padding: 12px 15px;
        text-align: center;
      }
      
      .form-submit {
        font-size: 20px;
        padding: 15px 30px;
        width: 100%;
        margin: 0 auto;
        display: block;
      }
      
      .contact-info {
        width: 100%;
        max-width: 400px;
        gap: 20px;
        margin: 0 auto;
        text-align: center;
      }
      
      .info-card {
        padding: 20px;
      }
      
      .info-title {
        font-size: 24px;
        margin-bottom: 20px;
      }
      
      .contact-item {
        padding: 12px 0;
      }
      
      .contact-link {
        font-size: 16px;
      }
      
      .how-title {
        font-size: 22px;
      }
      
      .how-text {
        font-size: 14px;
        line-height: 1.5;
      }
      
      /* Mobile Footer */
      footer {
        height: auto;
        min-height: 120px;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 15px 10px;
      }
      
      .footer-nav {
        position: static;
        transform: none;
        left: auto;
        top: auto;
        margin: 10px 0;
        flex-wrap: wrap;
        gap: 15px;
      }
      
      .footer-link {
        font-size: 18px;
      }
      
      .footer-contact {
        position: static;
        align-items: center;
        margin: 10px 0;
      }
      
      .footer-contact-text {
        font-size: 14px;
      }
      
      .footer-logo {
        width: 70px;
        height: 70px;
        margin: 10px 0;
      }
      
      /* Additional mobile styles for very small screens */
      @media (max-width: 480px) {
        .side-cart-view-btn {
          font-size: 18px;
          height: 44px;
          margin: 12px 12px 16px 12px;
          width: calc(100% - 24px);
        }
      }
      
      /* Additional mobile styles for very small screens */
      @media (max-width: 480px) {
        .side-cart-view-btn {
          font-size: 18px;
          height: 44px;
          margin: 12px 12px 16px 12px;
          width: calc(100% - 24px);
        }
      }
    }
    .side-cart-view-btn {
      width: 90%;
      margin: 16px auto 18px auto;
      height: 48px;
      background: #5EA189;
      color: #fff;
      font-family: 'Amatica SC', cursive;
      font-size: 24px;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
      display: block;
    }
    .side-cart-view-btn:hover {
      background: #4b8c74;
    }
    @media (max-width: 700px) {
      .shop-popup {
        top: 100%;
        right: 0;
        left: auto;
        min-width: 140px;
      }

      .popup-sub {
        position: absolute;
        right: auto;
        left: -110px; /* Width of sub-menu */
        top: 0;
        background: #f6eee0;
        border-radius: 8px;
        box-shadow: 0 2px 8px #0001;
        padding: 2px 0;
        min-width: 110px;
        z-index: 101;
      }

      .popup-main-btn.active + .popup-sub {
        display: block;
      }

      /* Ensure main menu items have position relative for proper sub-menu positioning */
      .shop-popup > ul > li {
        position: relative;
      }
    }
  </style>
</head>
<body>
  <div id="cartOverlay" class="cart-overlay"></div>
  <div id="cartDeleteDialog" class="cart-delete-dialog" style="display:none;">
    <div class="cart-delete-dialog-content">
      <div class="cart-delete-dialog-title">האם למחוק את המוצר מהעגלה?</div>
      <div class="cart-delete-dialog-actions">
        <button id="cartDeleteYes" class="cart-delete-btn-yes">כן</button>
        <button id="cartDeleteNo" class="cart-delete-btn-no">לא</button>
      </div>
    </div>
  </div>
  <aside id="sideCart" class="side-cart">
    <div class="side-cart-header">
      <span class="side-cart-title">סל קניות</span>
      <button class="side-cart-close" id="closeSideCart">×</button>
    </div>
    <div class="side-cart-list" id="sideCartList">
      <!-- כאן יתווספו המוצרים -->
    </div>
    <button class="side-cart-view-btn" id="viewCartBtn">לצפייה בסל הקניות</button>
  </aside>
  <div class="body-center">
    <header>
      <div class="logo"></div>
      <a class="cart">
        <div class="cart-icon">
          <span class="cart-badge" id="cartBadge" style="display:none;">0</span>
        </div>
      </a>
    </header>

    <nav>
      <a class="nav-link" href="homepage.html">דף הבית</a>
      <button class="nav-link shop-popup-btn" id="shopPopupBtn" type="button">חנות</button>
      <a class="nav-link" href="policy.html">מדיניות</a>
      <a class="nav-link" href="contact.html">צור קשר</a>
    </nav>

    <section class="contact-section">
      <h1 class="contact-title">צור קשר</h1>
      
      <div class="contact-content">
        <!-- Contact Form -->
        <div class="contact-form">
          <h2 class="form-title">שלח לנו הודעה</h2>
          
          <div class="success-message" id="successMessage">
            תודה על פנייתך! ההודעה נשלחה בהצלחה. נחזור אליך בהקדם האפשרי.
          </div>
          
          <form id="contactForm" novalidate>
            <div class="form-group">
              <label class="form-label" for="name">שם מלא <span class="required-asterisk">*</span></label>
              <input type="text" id="name" name="name" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="email">כתובת אימייל <span class="required-asterisk">*</span></label>
              <input type="email" id="email" name="email" class="form-input" required dir="ltr" placeholder="your@email.com">
              <div class="field-error" id="emailError"></div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="phone">מספר טלפון</label>
              <input type="tel" id="phone" name="phone" class="form-input" dir="ltr" placeholder="050-1234567">
              <div class="field-error" id="phoneError"></div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="subject">נושא <span class="required-asterisk">*</span></label>
              <input type="text" id="subject" name="subject" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="message">הודעה <span class="required-asterisk">*</span></label>
              <textarea id="message" name="message" class="form-textarea" required placeholder="ספר לנו על הרעיון שלך..."></textarea>
            </div>
            
            <button type="submit" class="form-submit">שלח הודעה</button>
          </form>
        </div>

        <!-- Contact Info -->
        <div class="contact-info">
          <div class="info-card">
            <h3 class="info-title">פרטי יצירת קשר</h3>
            
            <div class="contact-item">
              <div class="contact-icon" style="background-image: url('email.svg');"></div>
              <a href="mailto:paintz.yf@gmail.com" class="contact-link">paintz.yf@gmail.com</a>
            </div>
            
            <div class="contact-item">
              <div class="contact-icon" style="background-image: url('instagram.svg');"></div>
              <a href="https://www.instagram.com/paintz.official/" target="_blank" class="contact-link">paintz.official@</a>
            </div>
            
            <div class="contact-item">
              <a href="https://maps.google.com/?q=פתח+תקווה" target="_blank">
                <div class="contact-icon" style="background-image: url('location.svg');"></div>
              </a>
              <a href="https://maps.google.com/?q=פתח+תקווה" target="_blank" class="contact-link"><span>פתח תקווה</span></a>
            </div>
          </div>
          
          <div class="info-card">
            <h3 class="info-title">זמני תגובה</h3>
            <p style="text-align: center; color: #775A47; font-family: 'Rubik', sans-serif; line-height: 1.2; margin: 0; font-size: 15px;">
              אנחנו חוזרים לכל הפניות בתוך 24 שעות בימי עבודה.
              <br>
              עבור הזמנות דחופות, צרו קשר דרך האינסטגרם.
            </p>
          </div>

          <div class="how-it-works">
            <h4 class="how-title">מתי לפנות אלינו?</h4>
            <p class="how-text">
              דף צור קשר מיועד לתקלות, בקשות מיוחדות, אי הבנות או שאלות כלליות.
              <br>
              לעיצוב מוצרים חדשים, היכנסו לחנות ובחרו את המוצר הרצוי ❤️
            </p>
          </div>
        </div>
      </div>
    </section>
  </div>
  
  <footer>
    <div class="footer-content">
      <div class="footer-nav">
        <a href="homepage.html" class="footer-link">דף הבית</a>
        <span class="footer-sep">│</span>
        <a href="shop.html" class="footer-link">חנות</a>
        <span class="footer-sep">│</span>
        <a href="policy.html" class="footer-link">מדיניות</a>
        <span class="footer-sep">│</span>
        <a href="contact.html" class="footer-link">צור קשר</a>
      </div>
      <div class="footer-contact">
        <div class="footer-contact-item">
          <a href="https://www.instagram.com/paintz.official/" target="_blank" rel="noopener">
            <img src="instagram.svg" alt="Instagram" class="footer-icon" />
          </a>
          <span class="footer-contact-text">  paintz.official@</span>
        </div>
        <div class="footer-contact-item">
          <a href="mailto:paintz.yf@gmail.com">
            <img src="email.svg" alt="Email" class="footer-icon" />
          </a>
          <span class="footer-contact-text">  paintz.yf@gmail.com</span>
        </div>
        <div class="footer-contact-item">
          <a href="https://maps.google.com/?q=פתח+תקווה" target="_blank">
            <img src="location.svg" alt="Location" class="footer-icon" />
          </a>
          <span class="footer-contact-text">פתח תקווה  </span>
        </div>
      </div>
    </div>
    <div class="footer-logo"></div>
  </footer>
  
  <section class="copyright-section">
    <div class="copyright-text">Paintz 2025©</div>
  </section>

  <!-- Popup Menu -->
  <div class="shop-popup" id="shopPopup">
    <ul>
      <li><a href="shop.html">כללי</a></li>
      <li>
        <button class="popup-main-btn" type="button" data-target="sheshbesh">שש בש</button>
        <ul class="popup-sub" id="sub-sheshbesh">
          <li><a href="Backgammon Custum.html">עיצוב אישי</a></li>
          <li><a href="Backgammon Models.html">דגמים</a></li>
        </ul>
      </li>
      <li>
        <button class="popup-main-btn" type="button" data-target="matkot">מטקות</button>
        <ul class="popup-sub" id="sub-matkot">
          <li><a href="Matka Custum.html">עיצוב אישי</a></li>
          <li><a href="Matka Models.html">דגמים</a></li>
        </ul>
      </li>
      <li><a href="Canvas.html">קנבסים</a></li>
      <li><a href="Record.html">תקליטים</a></li>
    </ul>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script src="cart-sync.js"></script>
  <script>
    // וידוא שה-side-cart מוסתר בטעינת הדף
    document.addEventListener('DOMContentLoaded', function() {
      const sideCart = document.getElementById('sideCart');
      if (sideCart) {
        sideCart.classList.remove('active');
      }
    });
    // Initialize EmailJS
    (function(){
      emailjs.init("72bVeRLtuT98SDWTK"); // Your EmailJS public key
  
    })();

    // --- Shop Popup Logic - Simplified to match other pages ---
    const shopBtn = document.getElementById('shopPopupBtn');
    const shopPopup = document.getElementById('shopPopup');

    function positionShopPopup() {
      const rect = shopBtn.getBoundingClientRect();
      shopPopup.style.top = rect.bottom + 'px';
      shopPopup.style.right = (window.innerWidth - rect.right) + 'px';
      shopPopup.style.left = 'auto';
      shopPopup.style.transform = 'none';
    }

    function openShopPopup() {
      positionShopPopup();
      shopPopup.style.display = 'block';
    }
    function closeShopPopup() {
      shopPopup.style.display = 'none';
      closeAllSubs();
    }

    // Add sub-menu handling
    const mainButtons = document.querySelectorAll('.popup-main-btn');
    mainButtons.forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.stopPropagation();
        const target = this.dataset.target;
        const subMenu = document.getElementById('sub-' + target);
        
        // Close all other sub-menus first
        document.querySelectorAll('.popup-sub').forEach(sub => {
          if (sub !== subMenu) {
            sub.style.display = 'none';
          }
        });
        
        // Toggle current sub-menu
        if (subMenu) {
          const isVisible = subMenu.style.display === 'block';
          subMenu.style.display = isVisible ? 'none' : 'block';
          
          // Remove active class from all buttons
          mainButtons.forEach(b => b.classList.remove('active'));
          
          // Add active class to current button if sub-menu is visible
          if (!isVisible) {
            this.classList.add('active');
          }
        }
      });
    });

    function setShopPopupEvents() {
      if (window.innerWidth > 700) {
        shopBtn.removeEventListener('click', shopBtn._shopClickHandler || (()=>{}));
        
        // Hover functionality with delay
        let hoverTimeout;
        let isHovering = false;
        
        shopBtn.addEventListener('mouseenter', function() {
          isHovering = true;
          clearTimeout(hoverTimeout);
          openShopPopup();
        });
        
        shopBtn.addEventListener('mouseleave', function() {
          isHovering = false;
          hoverTimeout = setTimeout(() => {
            if (!isHovering) closeShopPopup();
          }, 200);
        });
        
        shopPopup.addEventListener('mouseenter', function() {
          isHovering = true;
          clearTimeout(hoverTimeout);
        });
        
        shopPopup.addEventListener('mouseleave', function() {
          isHovering = false;
          hoverTimeout = setTimeout(() => {
            if (!isHovering) closeShopPopup();
          }, 200);
        });
        
      } else {
        shopBtn._shopClickHandler = function(e) {
          e.stopPropagation();
          if (shopPopup.style.display === 'block') {
            closeShopPopup();
          } else {
            openShopPopup();
          }
        };
        shopBtn.addEventListener('click', shopBtn._shopClickHandler);
      }
    }
    setShopPopupEvents();
    window.addEventListener('resize', setShopPopupEvents);
    window.addEventListener('resize', function() {
      if (shopPopup.style.display === 'block') {
        positionShopPopup();
      }
    });
    document.addEventListener('click', function(e) {
      if (!shopPopup.contains(e.target) && e.target !== shopBtn) {
        closeShopPopup();
      }
    });
    function closeAllSubs() {
      document.querySelectorAll('.popup-sub').forEach(sub => sub.style.display = 'none');
    }

    // Contact form functionality - using EmailJS
    const contactForm = document.getElementById('contactForm');
    const successMessage = document.getElementById('successMessage');

    // Helper functions
    function showSuccess(message) {
      successMessage.textContent = message;
      successMessage.style.display = 'block';
      setTimeout(() => {
        successMessage.style.display = 'none';
      }, 5000);
    }

    function showError(message) {
      alert(message); // Simple error display
    }

    // Form submission handler
    async function handleSubmit(event) {
      event.preventDefault();
      
      // Get form data
      const form = event.target;
      const formData = new FormData(form);
      
      // Reset all borders to default and hide error messages
      const inputs = form.querySelectorAll('.form-input, .form-textarea');
      inputs.forEach(input => {
        input.style.borderColor = '#D3B895';
      });
      
      // Hide all error messages
      document.getElementById('emailError').style.display = 'none';
      document.getElementById('phoneError').style.display = 'none';
      
      // Check required fields and mark invalid ones with red border
      let hasErrors = false;
      const requiredFields = form.querySelectorAll('[required]');
      
      requiredFields.forEach(field => {
        if (!field.value.trim()) {
          field.style.borderColor = '#e74c3c';
          hasErrors = true;
        }
      });
      
      // Check email format - simple validation
      const emailField = form.querySelector('#email');
      const emailError = document.getElementById('emailError');
      if (emailField && emailField.value.trim()) {
        const emailValue = emailField.value.trim();
        // Simple email validation - just check basic format
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (!emailRegex.test(emailValue)) {
          emailField.style.borderColor = '#e74c3c';
          emailError.textContent = 'כתובת אימייל לא תקינה. דוגמה: user@gmail.com';
          emailError.style.display = 'block';
          hasErrors = true;
        } else {
          emailError.style.display = 'none';
        }
      } else {
        emailError.style.display = 'none';
      }
      
      // Check phone format - simple validation
      const phoneField = form.querySelector('#phone');
      const phoneError = document.getElementById('phoneError');
      if (phoneField && phoneField.value.trim()) {
        const phoneValue = phoneField.value.trim();
        // Simple phone validation - just check if it contains enough digits
        const phoneDigits = phoneValue.replace(/\D/g, '');
        
        if (phoneDigits.length < 7 || phoneDigits.length > 15) {
          phoneField.style.borderColor = '#e74c3c';
          phoneError.textContent = 'מספר טלפון לא תקין. דוגמאות: 050-1234567, +972-50-1234567, 02-1234567';
          phoneError.style.display = 'block';
          hasErrors = true;
        } else {
          phoneError.style.display = 'none';
        }
      } else {
        phoneError.style.display = 'none';
      }
      
      // If there are validation errors, don't submit
      if (hasErrors) {
        return;
      }
      
      try {
        // Prepare email parameters for both templates
        const templateParams = {
          from_name: formData.get('name') || '',
          from_email: formData.get('email') || '',
          phone: formData.get('phone') || 'לא צוין',
          subject: formData.get('subject') || '',
          message: formData.get('message') || ''
        };
        
    
        
        // Send only the inquiry email first (to test)
        // Use the correct service ID
        const serviceId = 'service_8hy0sei';
        
        // Send the inquiry email (to you)
        const response1 = await emailjs.send(serviceId, 'template_xbw6nas', templateParams);

        
        // Send confirmation email to customer
        try {
          const response2 = await emailjs.send(serviceId, 'template_429wcvb', templateParams);
  
        } catch (confirmError) {
          console.warn('Confirmation email failed, but inquiry was sent:', confirmError);
        }
        
        // Show success message
        showSuccess('ההודעה נשלחה בהצלחה!');
        form.reset();
        
        // Reset border colors after successful submission
        const allInputs = form.querySelectorAll('.form-input, .form-textarea');
        allInputs.forEach(input => {
          input.style.borderColor = '#D3B895';
        });
        
      } catch (emailError) {
        console.error('EmailJS failed with error:', emailError);
        console.error('Error details:', {
          status: emailError.status,
          text: emailError.text,
          message: emailError.message
        });
        
        // Check if it's a 400 error (Bad Request)
        if (emailError.status === 400) {
          console.error('400 Error - probably template or service issue');
          console.error('Check if service_paintz and template_xbw6nas exist in your EmailJS dashboard');
        }
        
        // Fallback to mailto with formatted content
        const subject = encodeURIComponent(`פניה מצור קשר | ${formData.get('subject') || ''}`);
        const body = encodeURIComponent(
          `${formData.get('name')}: ${formData.get('subject')} | פניה מצור קשר\n\n` +
          `שם: ${formData.get('name')}\n` +
          `אימייל: ${formData.get('email')}\n` +
          `טלפון: ${formData.get('phone') || 'לא צוין'}\n` +
          `נושא: ${formData.get('subject')}\n\n` +
          `הודעה:\n${formData.get('message')}`
        );
        const mailtoLink = `mailto:paintz.yf@gmail.com?subject=${subject}&body=${body}`;
        window.location.href = mailtoLink;
        showSuccess('נפתח חלון שליחת מייל. אנא שלח את ההודעה מתוכנת המייל שלך.');
      }
    }

    // Attach event listener to form
    contactForm.addEventListener('submit', handleSubmit);
    
    // Check if EmailJS is loaded
    if (typeof emailjs === 'undefined') {
      console.error('EmailJS is not loaded!');
    } else {
  
    }

    // Input validation feedback
    const inputs = document.querySelectorAll('.form-input, .form-textarea');
    inputs.forEach(input => {
      input.addEventListener('input', function() {
        // כאשר המשתמש מתחיל להקליד, החזר למסגרת רגילה והסתר הודעות שגיאה
        this.style.borderColor = '#D3B895';
        
        // Hide error messages when user starts typing
        if (this.id === 'email') {
          document.getElementById('emailError').style.display = 'none';
        } else if (this.id === 'phone') {
          document.getElementById('phoneError').style.display = 'none';
        }
      });
      
      input.addEventListener('focus', function() {
        this.style.borderColor = '#BA8663';
      });
    });

    // Cart badge (load from localStorage like other pages)
    const cartBadge = document.getElementById('cartBadge');
    function updateCartBadge() {
      try {
        const cart = JSON.parse(localStorage.getItem('cart') || '[]');
        const total = cart.reduce((sum, item) => sum + (item.qty || 1), 0);
        if (total > 0) {
          cartBadge.style.display = 'flex';
          cartBadge.textContent = total;
        } else {
          cartBadge.style.display = 'none';
        }
      } catch (e) {
        cartBadge.style.display = 'none';
      }
    }
    updateCartBadge();

    // --- Side Cart Logic ---
    let cart = [];

function initializeCart() {
  if (window.cartSync && typeof window.cartSync.loadCart === 'function') {
    cart = window.cartSync.loadCart();
  } else {
    try {
      cart = JSON.parse(localStorage.getItem('cart') || '[]');
    } catch (e) {
      cart = [];
    }
  }
}

initializeCart();
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(initializeCart, 100);
});

    const cartBtn = document.querySelector('.cart');
    const sideCart = document.getElementById('sideCart');
    const cartOverlay = document.getElementById('cartOverlay');
    const closeSideCartBtn = document.getElementById('closeSideCart');
    const sideCartList = document.getElementById('sideCartList');
    const viewCartBtn = document.getElementById('viewCartBtn');

    function getColorFromName(name) {
      // מפה בסיסית של שמות צבעים נפוצים לגוון
      const colors = {
        'תכלת': '#7ed6f7',
        'טורקיז': '#40e0d0',
        'אדום': '#e74c3c',
        'כחול': '#2980b9',
        'ירוק': '#27ae60',
        'צהוב': '#f9e79f',
        'שחור': '#222',
        'לבן': '#fff',
        'כתום': '#f39c12',
        'סגול': '#8e44ad',
        'ורוד': '#fd79a8',
        'חום': '#a0522d',
        'אפור': '#7f8c8d',
        'זהב': '#ffd700',
        'כסף': '#bdc3c7',
      };
      return colors[name.trim()] || '#b2bec3'; // ברירת מחדל
    }

    function truncateText(text, maxLength = 10) {
      if (!text) return '';
      return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
    }

    // תיקון עיבוד הצבעים
    function renderCartNotes(item) {
      const details = [];
      const notesText = item.notes || '';
      let colorBox = '';

      // עיבוד מיוחד לשש בש עיצוב אישי
      const allTitles = ((item.title || '') + ' ' + (item.subtitle || '')).toLowerCase();
      if (allTitles.includes('שש בש') && allTitles.includes('עיצוב אישי')) {
        const colorLines = [];
        const regex = /(צבע [^:]+):\s*([^,]+(?:, [^:]+)*)(?=,\s*צבע|$)/g;
        let match;
        while ((match = regex.exec(notesText)) !== null) {
          const label = match[1];
          const colors = match[2].split(',').map(s => s.trim()).filter(Boolean);
          const colorBoxes = colors.map(c => {
            if (label.includes('משולש') && c === 'משתנה') {
              return 'משתנה';
            } else if (c === 'משתנה') {
              return 'משתנה';
            } else {
              return `<span class='side-cart-item-color-box' style='background:${getColorFromName(c)}' title='${c}'></span>`;
            }
          }).join(' ');
          colorLines.push(`<li>${l}</li>`);
        }
        if (colorLines.length) {
          details.push(...colorLines.map(l => `<li>${l}</li>`));
        }
      } else if (allTitles.includes('מטקה') && allTitles.includes('עיצוב אישי')) {
        // עיבוד מיוחד למטקה עיצוב אישי
        const colors = [];
        const explanations = [];
        const matkaRegex = /(צבע מטקה [12]|הסבר מטקה [12]):\s*([^,]+)(?=,\s*(?:צבע מטקה|הסבר מטקה)|$)/g;
        let match;
        while ((match = matkaRegex.exec(notesText)) !== null) {
          const label = match[1];
          const value = match[2].trim();
          
          if (label.includes('צבע מטקה')) {
            const colorHex = getColorFromName(value);
            const colorBox = `<span class='side-cart-item-color-box' style='background:${colorHex}' title='${value}'></span>`;
            colors.push(colorBox);
          } else if (label.includes('הסבר מטקה')) {
            explanations.push(truncateText(value, 8));
          }
        }
        
        if (colors.length > 0) {
          details.push(`<li><span class='side-cart-item-details-label'>צבעי מטקה:</span><span class='side-cart-item-details-value'>${colors.join(' ')}</span></li>`);
        }
        
        if (explanations.length > 0) {
        explanations.forEach((explanation, index) => {
          details.push(`<li><span class='side-cart-item-details-label'>הסבר מטקה ${index + 1}:</span><span class='side-cart-item-details-value'>${explanation}</span></li>`);
        });
        }
      } else if (allTitles.includes('תקליט') && allTitles.includes('עיצוב אישי')) {
        // עיבוד מיוחד לתקליט עיצוב אישי - הוספת הערות
        const description = item.desc ? truncateText(item.desc).trim() : '';
        const note = notesText.trim() ? truncateText(notesText.trim()) : '';
        const fileName = item.file ? item.file.split(/[\/\\]/).pop() : '';
        const fileDisplay = fileName ? truncateText(fileName) : '';
        
        // Check if description and note are the same
        if (description && note && description === note) {
          // If they are the same, show only one line
          details.push(`<li><span class='side-cart-item-details-label'>הסבר:</span><span class='side-cart-item-details-value'>${description}</span></li>`);
        } else {
          // If they are different, show them separately
          if (description) {
            details.push(`<li><span class='side-cart-item-details-label'>הסבר:</span><span class='side-cart-item-details-value'>${description}</span></li>`);
          }
          if (note) {
            details.push(`<li><span class='side-cart-item-details-label'>הערה:</span><span class='side-cart-item-details-value'>${note}</span></li>`);
          }
        }
        
        // Handle file display for record items
        if (fileDisplay) {
          details.push(`<li><span class='side-cart-item-details-label'>קובץ:</span><span class='side-cart-item-details-value'>${fileDisplay}</span></li>`);
        }
      } else if (allTitles.includes('קנבס') && allTitles.includes('עיצוב אישי')) {
        // Special handling for custom canvas design - combine description, size, and file if they are the same
        const description = item.desc ? truncateText(item.desc).trim() : '';
        const size = notesText.trim() ? truncateText(notesText.trim()) : '';
        const fileName = item.file ? item.file.split(/[\/\\]/).pop() : '';
        const fileDisplay = fileName ? truncateText(fileName) : '';
        
        // Check if all three are the same
        if (description && size && fileDisplay && description === size && description === fileDisplay) {
          // If all are the same, show only one line
          details.push(`<li><span class='side-cart-item-details-label'>הסבר:</span><span class='side-cart-item-details-value'>${description}</span></li>`);
        } else {
          // If they are different, show them separately
          if (description) {
            details.push(`<li><span class='side-cart-item-details-label'>הסבר:</span><span class='side-cart-item-details-value'>${description}</span></li>`);
          }
          if (size) {
            details.push(`<li><span class='side-cart-item-details-label'>גודל:</span><span class='side-cart-item-details-value'>${size}</span></li>`);
          }
          if (fileDisplay) {
            details.push(`<li><span class='side-cart-item-details-label'>קובץ:</span><span class='side-cart-item-details-value'>${fileDisplay}</span></li>`);
          }
        }
      } else if (allTitles.includes('שש בש')) {
        if (notesText.trim()) {
          details.push(`<li><span class='side-cart-item-details-label'>הערה:</span><span class='side-cart-item-details-value'>${truncateText(notesText.trim())}</span></li>`);
        }
      } else {
        let noteLabel = 'הערה:';
        if (allTitles.includes('מטקה')) noteLabel = 'צבע:';
        else if (allTitles.includes('קנבס')) noteLabel = 'גודל:';
        
        // הערה: חפש "גוון: ..." והצג ריבוע צבע
        let colorMatch = notesText.match(/גוון\s*[:：]?\s*([\u0590-\u05FF\w]+)/);
        if (colorMatch) {
          const colorName = colorMatch[1];
          const colorHex = getColorFromName(colorName);
          colorBox = `<span class='side-cart-item-color-box' style='background:${colorHex}' title='${colorName}'></span>`;
          notesText = notesText.replace(/,?\s*גוון\s*[:：]?\s*[\u0590-\u05FF\w]+/, '');
        }
        
        if (allTitles.includes('מטקה')) {
          if (colorBox) {
            details.push(`<li><span class='side-cart-item-details-label'>${noteLabel}</span><span class='side-cart-item-details-value'>${colorBox}</span></li>`);
          }
        } else if (notesText.trim() || colorBox) {
          details.push(`<li><span class='side-cart-item-details-label'>${noteLabel}</span><span class='side-cart-item-details-value'>${truncateText(notesText.trim())} ${colorBox}</span></li>`);
        }
      }

      if (item.desc && !allTitles.includes('תקליט') && !(allTitles.includes('קנבס') && allTitles.includes('עיצוב אישי'))) {
        details.push(`<li><span class='side-cart-item-details-label'>הסבר:</span><span class='side-cart-item-details-value'>${truncateText(item.desc)}</span></li>`);
      }
      // Only show file for items that don't have their own file handling
      if (item.file && !allTitles.includes('תקליט') && !(allTitles.includes('קנבס') && allTitles.includes('עיצוב אישי'))) {
        // מחלץ את שם הקובץ מהנתיב המלא
        const fileName = item.file.split(/[\/\\]/).pop();
        details.push(`<li><span class='side-cart-item-details-label'>קובץ:</span><span class='side-cart-item-details-value'>${truncateText(fileName)}</span></li>`);
      }
      return details.join('');
    }

    function renderCart() {
      sideCartList.innerHTML = '';
      
      if (!cart.length) {
        sideCartList.innerHTML = '<div style="text-align: center; padding: 20px; font-family: \'Amatica SC\', cursive; font-size: 20px; color: #775A47;">העגלה ריקה</div>';
        return;
      }
      
      cart.forEach((item, idx) => {
        let mainTitle = 'עיצוב אישי';
        let subTitle = '';
              // Check if item has separate subtitle field (new format)
      if (item.subtitle) {
        mainTitle = item.title || '';
        subTitle = item.subtitle;
      } else if (item.title && item.title.includes('|')) {
          const parts = item.title.split('|');
          mainTitle = parts[0].trim();
          subTitle = parts[1].trim();
        } else if (item.title) {
          subTitle = item.title;
        }
        
        // קבלת הפרטים מהפונקציה המרכזית
    const details = window.cartSync && window.cartSync.renderCartNotes ? 
                  window.cartSync.renderCartNotes(item) : renderCartNotes(item);
        
        const row = document.createElement('div');
        row.className = 'side-cart-item';
        row.setAttribute('data-idx', idx);
        row.style.position = 'relative';
        row.innerHTML = `
          <div style="height: 120px; display: flex; flex-direction: row; width: 100%; position: relative;">
            <div style="flex: 1; height: 100%; display: flex; align-items: center;">
              <div style="width: 100%; display: flex; flex-direction: column; gap: 8px;">
                <div style="height: 30px; display: flex; align-items: center; justify-content: center;">
                  <span style="font-family: 'Amatica SC', cursive; font-size: 22px; font-weight: bold; color: #775A47; text-align: center; line-height: 1.1;">${mainTitle}</span>
                </div>
                <div style="height: 24px; display: flex; align-items: center; justify-content: center;">
                  <span style="font-family: 'Amatica SC', cursive; font-size: 16px; color: #BA8663; text-align: center; font-weight: normal;">${subTitle}</span>
                </div>
            ${window.cartSync && window.cartSync.renderCartPrice ? window.cartSync.renderCartPrice(item) : ''}
              </div>
            </div>
            <div style="width: 48px; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; margin-left: 8px;">
              <button class="side-cart-item-add-btn" title="הוסף" style="background: none; border: none; font-size: 22px; color: #5EA189; cursor: pointer; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center;">+</button>
              <span class="side-cart-item-qty" style="width: 32px; height: 28px; font-size: 18px; color: #BA8663; display: flex; align-items: center; justify-content: center; background: none; border-radius: 0; border: none; font-family: 'Amatica SC', cursive; font-weight: bold;">${item.qty}</span>
              <button class="side-cart-item-minus-btn" title="הפחת" style="background: none; border: none; font-size: 22px; color: #5EA189; cursor: pointer; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center;">–</button>
            </div>
          </div>
          <div class="side-cart-item-details" style="padding: 0 0 8px 0;">
            <ul class="side-cart-item-details-list" style="max-width: 100%; overflow: hidden;">
              ${details}
            </ul>
          </div>
          <button class="side-cart-item-trash-btn" title="מחק" style="position: absolute; left: 8px; bottom: 8px; background: none; border: none; padding: 0; margin: 0; cursor: pointer; width: 22px; height: 22px;"><span class="side-cart-item-trash-icon"></span></button>
        `;
        
        row.querySelector('.side-cart-item-trash-btn').onclick = function(e) {
          e.stopPropagation();
          showDeleteDialog(idx);
        };
        
                  // כפתור הוספה
            row.querySelector('.side-cart-item-add-btn').onclick = function(e) {
      e.stopPropagation();
        if (window.cartSync) {
          window.cartSync.updateItem(idx, {qty: cart[idx].qty + 1});
        cart = window.cartSync.loadCart();
        } else {
          cart[idx].qty += 1;
          localStorage.setItem('cart', JSON.stringify(cart));
        }
        updateCartBadge();
        renderCart();
    };
      // כפתור הפחתה
    row.querySelector('.side-cart-item-minus-btn').onclick = function(e) {
      e.stopPropagation();
      if (cart[idx].qty > 1) {
          if (window.cartSync) {
            window.cartSync.updateItem(idx, {qty: cart[idx].qty - 1});
          cart = window.cartSync.loadCart();
          } else {
            cart[idx].qty -= 1;
            localStorage.setItem('cart', JSON.stringify(cart));
          }
          updateCartBadge();
          renderCart();
      } else {
        showDeleteDialog(idx);
      }
    };
        
        sideCartList.appendChild(row);
      });
    }

    function openSideCart() {
      sideCart.classList.add('active');
      cartOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeSideCart() {
      sideCart.classList.remove('active');
      cartOverlay.classList.remove('active');
      document.body.style.overflow = '';
    }

    cartBtn.addEventListener('click', function(e) {
      e.preventDefault();
      openSideCart();
    });

    cartOverlay.addEventListener('click', closeSideCart);
    closeSideCartBtn.addEventListener('click', closeSideCart);

    viewCartBtn.addEventListener('click', function() {
      window.location.href = 'Shopping Cart.html';
    });

    function removeFromCart(idx) {
  if (idx >= 0 && idx < cart.length) {
      if (window.cartSync) {
        window.cartSync.removeItem(idx);
      cart = window.cartSync.loadCart();
    } else {
        cart.splice(idx, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
      }
        updateCartBadge();
        renderCart();
  }
}

    let cartDeleteIdx = null;
    function showDeleteDialog(idx) {
      cartDeleteIdx = idx;
      document.getElementById('cartDeleteDialog').style.display = 'flex';
    }

    document.getElementById('cartDeleteYes').onclick = function() {
      if (cartDeleteIdx !== null) {
        removeFromCart(cartDeleteIdx);
        cartDeleteIdx = null;
      }
      document.getElementById('cartDeleteDialog').style.display = 'none';
    };

    document.getElementById('cartDeleteNo').onclick = function() {
      cartDeleteIdx = null;
      document.getElementById('cartDeleteDialog').style.display = 'none';
    };

    // Initialize
    updateCartBadge();
    renderCart();

    // iPad and Safari specific fixes
    function ensureViewCartButtonVisibleOniPad() {
      const viewCartBtn = document.getElementById('viewCartBtn');
      if (viewCartBtn) {
        viewCartBtn.style.display = 'block';
        viewCartBtn.style.visibility = 'visible';
        viewCartBtn.style.opacity = '1';
        viewCartBtn.style.position = 'sticky';
        viewCartBtn.style.bottom = '0';
        viewCartBtn.style.zIndex = '9999';
        viewCartBtn.style.webkitTransform = 'none';
        viewCartBtn.style.transform = 'none';
      }
    }

    // Call the function multiple times to ensure it works
    setTimeout(ensureViewCartButtonVisibleOniPad, 100);
    setTimeout(ensureViewCartButtonVisibleOniPad, 500);
    setTimeout(ensureViewCartButtonVisibleOniPad, 1000);
    setTimeout(ensureViewCartButtonVisibleOniPad, 2000);
  </script>
</body>
</html> 